let u=n=class{constructor(){this.rules=[],this.toUpdate=new a.DisposableCollection,this.icons=new l.SyncReferenceCollection((e=>this.createPluginIcon(e))),this.iconSequence=0}init(){this.update(),this.themeService.onDidColorThemeChange((()=>this.update()))}update(){this.toUpdate.dispose();const e=this.style=document.createElement("style");e.type="text/css",e.media="screen",document.getElementsByTagName("head")[0].appendChild(e),this.toUpdate.push(a.Disposable.create((()=>document.getElementsByTagName("head")[0].removeChild(e))));for(const e of this.rules)this.doInsertRule(e)}insertRule(e,t){const i={selector:e,body:t};return this.rules.push(i),this.doInsertRule(i),a.Disposable.create((()=>{const t=this.rules.indexOf(i);-1!==t&&(this.rules.splice(t,1),this.deleteRule(e))}))}doInsertRule({selector:e,body:t}){const i=this.style.sheet,n=t(this.themeService.getCurrentTheme());i.insertRule(e+" {\n"+n+"\n}",0)}deleteRule(e){const t=this.style.sheet,i=t.rules||t.cssRules||[];for(let n=i.length-1;n>=0;n--)-1!==i[n].selectorText.indexOf(e)&&t.deleteRule(n)}toIconClass(e,{size:t}={size:16}){return this.icons.acquire({url:e,size:t})}createPluginIcon(e){const t=e.url,i=e.size,o=n.toExternalIconUrl(`${"object"==typeof t?t.dark:t}`),r=n.toExternalIconUrl(`${"object"==typeof t?t.light:t}`),s="plugin-icon-"+this.iconSequence++,c=new a.DisposableCollection;return c.push(this.insertRule("."+s,(e=>`\n                background-position: 2px;\n                width: ${i}px;\n                height: ${i}px;\n                background: center no-repeat url("${"light"===e.type?r:o}");\n                background-size: ${i}px;\n            `))),{iconClass:s,dispose:()=>c.dispose()}}static toExternalIconUrl(e){return e.startsWith("hostedPlugin/")?new d.Endpoint({path:e}).getRestUrl().toString():e}};o([(0,s.inject)(c.ThemeService),r("design:type",c.ThemeService)],u.prototype,"themeService",void 0),o([(0,s.postConstruct)(),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],u.prototype,"init",null),u=n=o([(0,s.injectable)()],u),t.PluginSharedStyle=u},87208:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StorageMainImpl=void 0;const n=i(32147),o=i(27030);t.StorageMainImpl=class{constructor(e){this.pluginServer=e.get(n.PluginServer),this.workspaceService=e.get(o.WorkspaceService)}$set(e,t,i){return this.pluginServer.setStorageValue(e,t,this.toKind(i))}$get(e,t){return this.pluginServer.getStorageValue(e,this.toKind(t))}$getAll(e){return this.pluginServer.getAllStorageValues(this.toKind(e))}toKind(e){var t;if(!e)return{workspace:null===(t=this.workspaceService.workspace)||void 0===t?void 0:t.resource.toString(),roots:this.workspaceService.tryGetRoots().map((e=>e.resource.toString()))}}}},94842:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.PluginTerminalRegistry=void 0;const o=i(70801);let r=class{start(e){return this.startCallback(e)}};r=n([(0,o.injectable)()],r),t.PluginTerminalRegistry=r},26625:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreferenceRegistryMainImpl=t.getPreferences=void 0;const n=i(98516),o=i(16138),r=i(92147),s=i(73246),a=i(51138);function c(e,t){const i=t.map((e=>e.resource.toString()));return n.PreferenceScope.getScopes().reduce(((t,o)=>{t[o]={};const r=e(o);if(o===n.PreferenceScope.Folder)for(const e of i){const i=r.getPreferences(e);t[o][e]=i}else t[o]=r.getPreferences();return t}),{})}t.getPreferences=c,t.PreferenceRegistryMainImpl=class{constructor(e,t){this.toDispose=new a.DisposableCollection,this.proxy=e.getProxy(o.MAIN_RPC_CONTEXT.PREFERENCE_REGISTRY_EXT),this.preferenceService=t.get(n.PreferenceService);const i=t.get(n.PreferenceProviderProvider),r=t.get(n.PreferenceServiceImpl),l=t.get(s.WorkspaceService);this.toDispose.push(r.onPreferencesChanged((e=>{const t=l.tryGetRoots(),o=c(i,t),r=Object.values(e).map((({scope:e,newValue:t,domain:i,preferenceName:o})=>({preferenceName:o,newValue:t,scope:e===n.PreferenceScope.User||null==i?void 0:i[0]})));this.proxy.$acceptConfigurationChanged(o,r)})))}dispose(){this.toDispose.dispose()}async $updateConfigurationOption(e,t,i,n,o){const r=this.parseConfigurationTarget(e,n),s=this.getEffectiveKey(t,r,o,n);await this.preferenceService.set(s,i,r,n)}async $removeConfigurationOption(e,t,i,n){const o=this.parseConfigurationTarget(e,i),r=this.getEffectiveKey(t,o,n,i);await this.preferenceService.set(r,void 0,o,i)}parseConfigurationTarget(e,t){if("boolean"==typeof e)return e?n.PreferenceScope.User:n.PreferenceScope.Workspace;switch(e){case r.ConfigurationTarget.Global:return n.PreferenceScope.User;case r.ConfigurationTarget.Workspace:return n.PreferenceScope.Workspace;case r.ConfigurationTarget.WorkspaceFolder:return n.PreferenceScope.Folder;default:return t?n.PreferenceScope.Folder:n.PreferenceScope.Workspace}}getEffectiveKey(e,t,i,n){if(i)return e;const o=this.preferenceService.overriddenPreferenceName(e);return o&&void 0===this.preferenceService.inspectInScope(e,t,n,i)?o.preferenceName:e}}},89282:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuickOpenMainImpl=void 0;const n=i(16138),o=i(87361),r=i(51138),s=i(98457),a=i(92147),c=i(13438),l=i(39539),d=i(56090);t.QuickOpenMainImpl=class{constructor(e,t){this.items={},this.toDispose=new r.DisposableCollection,this.sessions=new Map,this.proxy=e.getProxy(n.MAIN_RPC_CONTEXT.QUICK_OPEN_EXT),this.delegate=t.get(s.MonacoQuickInputService),this.quickInputService=t.get(o.QuickInputService)}dispose(){this.toDispose.dispose()}async $show(e,t,i){const n=new Promise(((t,i)=>{this.items[e]={resolve:t,reject:i}}));t={...t,onDidFocus:e=>{e&&this.proxy.$onItemSelected(e.handle)}};const o=await this.delegate.pick(n,t,i);return Array.isArray(o)?o.map((({handle:e})=>e)):o?o.handle:void 0}$setItems(e,t){return this.items[e]&&(this.items[e].resolve(t),delete this.items[e]),Promise.resolve()}$setError(e,t){return this.items[e]&&(this.items[e].reject(t),delete this.items[e]),Promise.resolve()}$input(e,t,i){var n;const o=Object.create(null);return e&&(o.title=e.title,o.password=e.password,o.placeHolder=e.placeHolder,o.valueSelection=e.valueSelection,o.prompt=e.prompt,o.value=e.value,o.ignoreFocusLost=e.ignoreFocusOut),t&&(o.validateInput=e=>this.proxy.$validateInput(e)),null===(n=this.quickInputService)||void 0===n?void 0:n.input(o,i)}async $showInputBox(e,t){return new Promise(((i,n)=>{var o;const s=e.id,a=new r.DisposableCollection,c=null===(o=this.quickInputService)||void 0===o?void 0:o.createInputBox();c.prompt=e.prompt,c.placeholder=e.placeHolder,c.value=e.value,e.busy&&(c.busy=e.busy),e.enabled&&(c.enabled=e.enabled),c.ignoreFocusOut=e.ignoreFocusOut,c.contextKey=e.contextKey,e.password&&(c.password=e.password),c.step=e.step,c.title=e.title,c.description=e.description,c.totalSteps=e.totalSteps,c.buttons=e.buttons?this.convertToQuickInputButtons(e.buttons):[],c.validationMessage=e.validationMessage,t&&(e.validateInput=e=>{this.proxy.$validateInput(e)}),a.push(c.onDidAccept((()=>{this.proxy.$acceptOnDidAccept(s),i(c.value)}))),a.push(c.onDidChangeValue((t=>{this.proxy.$acceptDidChangeValue(s,t),c.validationMessage=e.validateInput(t)}))),a.push(c.onDidTriggerButton((e=>{this.proxy.$acceptOnDidTriggerButton(s,e)}))),a.push(c.onDidHide((()=>{a.disposed||(this.proxy.$acceptOnDidHide(s),a.dispose(),i(void 0))}))),this.toDispose.push(a),c.show()}))}$createOrUpdate(e){const t=e.id;let i;const n=this.sessions.get(t);if(n)i=n;else{if("quickPick"===e.type){const e=this.quickInputService.createQuickPick();e.onDidAccept((()=>{this.proxy.$acceptOnDidAccept(t)})),e.onDidChangeActive((e=>{this.proxy.$onDidChangeActive(t,e.map((e=>e.handle)))})),e.onDidChangeSelection((e=>{this.proxy.$onDidChangeSelection(t,e.map((e=>e.handle)))})),e.onDidTriggerButton((e=>{this.proxy.$acceptOnDidTriggerButton(t,e)})),e.onDidTriggerItemButton((e=>{this.proxy.$onDidTriggerItemButton(t,e.item.handle,e.button.handle)})),e.onDidChangeValue((e=>{this.proxy.$acceptDidChangeValue(t,e)})),e.onDidHide((()=>{this.proxy.$acceptOnDidHide(t)})),i={input:e,handlesToItems:new Map}}else{const e=this.quickInputService.createInputBox();e.onDidAccept((()=>{this.proxy.$acceptOnDidAccept(t)})),e.onDidTriggerButton((e=>{this.proxy.$acceptOnDidTriggerButton(t,e)})),e.onDidChangeValue((e=>{this.proxy.$acceptDidChangeValue(t,e)})),e.onDidHide((()=>{this.proxy.$acceptOnDidHide(t)})),i={input:e,handlesToItems:new Map}}this.sessions.set(t,i)}if(i){const{input:t,handlesToItems:n}=i;for(const i in e)"id"!==i&&"type"!==i&&("visible"===i?e.visible?t.show():t.hide():"items"===i?(n.clear(),e[i].forEach((e=>{n.set(e.handle,e)})),t[i]=e[i]):t[i]="activeItems"===i||"selectedItems"===i?e[i].filter((e=>n.has(e))).map((e=>n.get(e))):"buttons"===i?e.buttons.map((e=>{if(-1===e.handle)return this.quickInputService.backButton;const{iconPath:t,tooltip:i,handle:n}=e;if("id"in t)return{iconClass:d.ThemeIcon.asClassName(t),tooltip:i,handle:n};{const e=t;return{iconPath:{dark:l.Uri.revive(e.dark),light:e.light&&l.Uri.revive(e.light)},tooltip:i,handle:n}}})):e[i])}return Promise.resolve(void 0)}$hide(){this.delegate.hide()}$dispose(e){const t=this.sessions.get(e);return t&&(t.input.dispose(),this.sessions.delete(e)),Promise.resolve(void 0)}convertToQuickInputButtons(e){return e.map(((e,t)=>({...(0,c.getIconPathOrClass)(e),tooltip:e.tooltip,handle:e===a.QuickInputButtons.Back?-1:t})))}}},20406:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScmMainImpl=t.PluginScmProvider=t.PluginScmResource=t.PluginScmResourceGroup=void 0;const n=i(16138),o=i(85656),r=i(18894),s=i(51138),a=i(30970),c=i(10433),l=i(53414),d=i(34291),u=i(56090);class h{constructor(e,t,i,n,o){this.handle=e,this.provider=t,this.features=i,this.label=n,this.id=o,this.resources=[],this.onDidSpliceEmitter=new r.Emitter,this.onDidSplice=this.onDidSpliceEmitter.event,this.onDidChangeEmitter=new r.Emitter,this.onDidChange=this.onDidChangeEmitter.event}get hideWhenEmpty(){return!!this.features.hideWhenEmpty}splice(e,t,i){this.resources.splice(e,t,...i),this.onDidSpliceEmitter.fire({start:e,deleteCount:t,toInsert:i})}updateGroup(e){this.features={...this.features,...e},this.onDidChangeEmitter.fire()}updateGroupLabel(e){this.label=e,this.onDidChangeEmitter.fire()}dispose(){}}t.PluginScmResourceGroup=h;class p{constructor(e,t,i,n,o,r,s,a,c){this.proxy=e,this.sourceControlHandle=t,this.groupHandle=i,this.handle=n,this.sourceUri=o,this.group=r,this.decorations=s,this.contextValue=a,this.command=c}open(){return this.proxy.$executeResourceCommand(this.sourceControlHandle,this.groupHandle,this.handle)}}t.PluginScmResource=p;class g{constructor(e,t,i,n,o,s,a,c){this.proxy=e,this.colors=t,this.sharedStyle=i,this._handle=n,this._contextValue=o,this._label=s,this._rootUri=a,this.disposables=c,this._id=this.contextValue,this.groups=[],this.groupsByHandle=Object.create(null),this.onDidChangeResourcesEmitter=new r.Emitter,this.onDidChangeResources=this.onDidChangeResourcesEmitter.event,this.features={},this.onDidChangeCommitTemplateEmitter=new r.Emitter,this.onDidChangeCommitTemplate=this.onDidChangeCommitTemplateEmitter.event,this.onDidChangeStatusBarCommandsEmitter=new r.Emitter,this.onDidChangeEmitter=new r.Emitter,this.onDidChange=this.onDidChangeEmitter.event}get id(){return this._id}get handle(){return this._handle}get label(){return this._label}get rootUri(){return this._rootUri?this._rootUri.toString():""}get contextValue(){return this._contextValue}get commitTemplate(){return this.features.commitTemplate||""}get acceptInputCommand(){const e=this.features.acceptInputCommand;if(e){const t=e;return t.command=e.id,t}}get statusBarCommands(){const e=this.features.statusBarCommands;return null==e?void 0:e.map((e=>{const t=e;return t.command=e.id,t}))}get count(){return this.features.count}get onDidChangeStatusBarCommands(){return this.onDidChangeStatusBarCommandsEmitter.event}updateSourceControl(e){this.features={...this.features,...e},this.onDidChangeEmitter.fire(),void 0!==e.commitTemplate&&this.onDidChangeCommitTemplateEmitter.fire(this.commitTemplate),void 0!==e.statusBarCommands&&this.onDidChangeStatusBarCommandsEmitter.fire(this.statusBarCommands)}registerGroups(e){const t=e.map((e=>{const{handle:t,id:i,label:n,features:o}=e,r=new h(t,this,o,n,i);return this.groupsByHandle[t]=r,r}));this.groups.splice(this.groups.length,0,...t)}updateGroup(e,t){const i=this.groupsByHandle[e];i&&i.updateGroup(t)}updateGroupLabel(e,t){const i=this.groupsByHandle[e];i&&i.updateGroupLabel(t)}spliceGroupResourceStates(e){for(const t of e){const e=t.handle,i=t.splices,n=this.groupsByHandle[e];if(n){i.reverse();for(const t of i){const{start:i,deleteCount:o,rawResources:r}=t,s=r.map((t=>{const{handle:i,sourceUri:o,icons:r,tooltip:s,strikeThrough:l,faded:d,contextValue:u,command:h}=t,g=this.toIconClass(r[0]),f=this.toIconClass(r[1])||g,m=t.colorId&&this.colors.toCssVariableName(t.colorId),b={icon:g,iconDark:f,tooltip:s,strikeThrough:l,letter:t.letter||"",color:m&&`var(${m})`,faded:d};return new p(this.proxy,this.handle,e,i,new a.default(c.URI.revive(o)),n,b,u||void 0,h)}));n.splice(i,o,s)}}else console.warn(`SCM group ${e} not found in provider ${this.label}`)}this.onDidChangeResourcesEmitter.fire()}toIconClass(e){if(!e)return;if(u.ThemeIcon.isThemeIcon(e))return u.ThemeIcon.asClassName(e);const t=this.sharedStyle.toIconClass(e);return this.disposables.push(t),t.object.iconClass}unregisterGroup(e){const t=this.groupsByHandle[e];t&&(delete this.groupsByHandle[e],this.groups.splice(this.groups.indexOf(t),1))}dispose(){}}t.PluginScmProvider=g,t.ScmMainImpl=class{constructor(e,t){this.repositories=new Map,this.repositoryDisposables=new Map,this.disposables=new s.DisposableCollection,this.proxy=e.getProxy(n.MAIN_RPC_CONTEXT.SCM_EXT),this.scmService=t.get(o.ScmService),this.colors=t.get(l.ColorRegistry),this.sharedStyle=t.get(d.PluginSharedStyle)}dispose(){this.repositories.forEach((e=>e.dispose())),this.repositories.clear(),this.repositoryDisposables.forEach((e=>e.dispose())),this.repositoryDisposables.clear(),this.disposables.dispose()}async $registerSourceControl(e,t,i,n){const o=new g(this.proxy,this.colors,this.sharedStyle,e,t,i,n?c.URI.revive(n):void 0,this.disposables),r=this.scmService.registerScmProvider(o,{input:{validator:async t=>{const i=await this.proxy.$validateInput(e,t,t.length);return i&&{message:i[0],type:i[1]}}}});this.repositories.set(e,r);const a=new s.DisposableCollection(this.scmService.onDidChangeSelectedRepository((t=>{t===r&&this.proxy.$setSelectedSourceControl(e)})),r.input.onDidChange((()=>this.proxy.$onInputBoxValueChange(e,r.input.value))));this.scmService.selectedRepository===r&&setTimeout((()=>this.proxy.$setSelectedSourceControl(e)),0),r.input.value&&setTimeout((()=>this.proxy.$onInputBoxValueChange(e,r.input.value)),0),this.repositoryDisposables.set(e,a)}async $updateSourceControl(e,t){const i=this.repositories.get(e);i&&i.provider.updateSourceControl(t)}async $unregisterSourceControl(e){const t=this.repositories.get(e);t&&(this.repositoryDisposables.get(e).dispose(),this.repositoryDisposables.delete(e),t.dispose(),this.repositories.delete(e))}$registerGroups(e,t,i){const n=this.repositories.get(e);if(!n)return;const o=n.provider;o.registerGroups(t),o.spliceGroupResourceStates(i)}$updateGroup(e,t,i){const n=this.repositories.get(e);n&&n.provider.updateGroup(t,i)}$updateGroupLabel(e,t,i){const n=this.repositories.get(e);n&&n.provider.updateGroupLabel(t,i)}$spliceResourceStates(e,t){const i=this.repositories.get(e);i&&i.provider.spliceGroupResourceStates(t)}$unregisterGroup(e,t){const i=this.repositories.get(e);i&&i.provider.unregisterGroup(t)}$setInputBoxValue(e,t){const i=this.repositories.get(e);i&&(i.input.value=t)}$setInputBoxPlaceholder(e,t){const i=this.repositories.get(e);i&&(i.input.placeholder=t)}$setInputBoxVisible(e,t){const i=this.repositories.get(e);i&&(i.input.visible=t)}$setInputBoxEnabled(e,t){const i=this.repositories.get(e);i&&(i.input.enabled=t)}}},85194:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SecretsMainImpl=void 0;const n=i(14820),o=i(40164);class r{constructor(e,t){this.proxy=e.getProxy(n.MAIN_RPC_CONTEXT.SECRETS_EXT),this.credentialsService=t.get(o.CredentialsService),this.credentialsService.onDidChangePassword((e=>{const t=e.service.substring(window.location.hostname.length+1);this.proxy.$onDidChangePassword({extensionId:t,key:e.account})}))}static getFullKey(e){return`${window.location.hostname}-${e}`}async $getPassword(e,t){const i=r.getFullKey(e),n=await this.credentialsService.getPassword(i,t);if(n)try{const t=JSON.parse(n);if(t.extensionId===e)return t.content}catch(e){throw new Error("Cannot get password")}}async $setPassword(e,t,i){const n=r.getFullKey(e),o=JSON.stringify({extensionId:e,content:i});return this.credentialsService.setPassword(n,t,o)}async $deletePassword(e,t){try{const i=r.getFullKey(e);await this.credentialsService.deletePassword(i,t)}catch(e){throw new Error("Cannot delete password")}}}t.SecretsMainImpl=r},15093:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionProviderCommandContribution=t.SelectionProviderCommands=void 0;const r=i(70801),s=i(8433),a=i(9825),c=i(40824);var l;!function(e){e.GET_SELECTED_CONTEXT={id:"theia.plugin.workspace.selectedContext"}}(l=t.SelectionProviderCommands||(t.SelectionProviderCommands={}));let d=class{registerCommands(e){e.registerCommand(l.GET_SELECTED_CONTEXT,this.newMultiUriAwareCommandHandler({isEnabled:()=>!0,isVisible:()=>!1,execute:e=>e.map((e=>(0,c.theiaUritoUriComponents)(e)))}))}newMultiUriAwareCommandHandler(e){return s.UriAwareCommandHandler.MultiSelect(this.selectionService,e)}};n([(0,r.inject)(a.SelectionService),o("design:type",a.SelectionService)],d.prototype,"selectionService",void 0),d=n([(0,r.injectable)()],d),t.SelectionProviderCommandContribution=d},81341:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StatusBarMessageRegistryMainImpl=void 0;const n=i(51138),o=i(92147),r=i(36245),s=i(53414);t.StatusBarMessageRegistryMainImpl=class{constructor(e){this.entries=new Map,this.toDispose=new n.DisposableCollection(n.Disposable.create((()=>{}))),this.delegate=e.get(r.StatusBar),this.colorRegistry=e.get(s.ColorRegistry)}dispose(){this.toDispose.dispose()}async $setMessage(e,t,i,s,a,c,l,d,u,h,p){const g={name:t,text:i||"",ariaLabel:null==h?void 0:h.label,role:null==h?void 0:h.role,priority:s,alignment:a===o.StatusBarAlignment.Left?r.StatusBarAlignment.LEFT:r.StatusBarAlignment.RIGHT,color:c&&(this.colorRegistry.getCurrentColor(c)||c),backgroundColor:l&&this.colorRegistry.getCurrentColor(l),tooltip:d,command:u,accessibilityInformation:h,args:p};this.entries.set(e,g),await this.delegate.setElement(e,g),this.toDispose.disposed?this.$dispose(e):this.toDispose.push(n.Disposable.create((()=>this.$dispose(e))))}$dispose(e){this.entries.get(e)&&(this.entries.delete(e),this.delegate.removeElement(e))}}},36015:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TabsMainImpl=void 0;const n=i(87361),o=i(16138),r=i(42933),s=i(75437),a=i(23281),c=i(23518),l=i(21723),d=i(9825);t.TabsMainImpl=class{constructor(e,t){this.tabGroupModel=new Map,this.tabInfoLookup=new Map,this.disposableTabBarListeners=new d.DisposableCollection,this.toDisposeOnDestroy=new d.DisposableCollection,this.groupIdCounter=0,this.tabGroupChanged=!1,this.proxy=e.getProxy(o.MAIN_RPC_CONTEXT.TABS_EXT),this.applicationShell=t.get(n.ApplicationShell),this.createTabsModel();const i=this.applicationShell.mainPanel.tabBars();for(let e;e=i.next();)this.attachListenersToTabBar(e);this.toDisposeOnDestroy.push(this.applicationShell.mainPanelRenderer.onDidCreateTabBar((e=>{this.attachListenersToTabBar(e),this.onTabGroupCreated(e)}))),this.connectToSignal(this.toDisposeOnDestroy,this.applicationShell.mainPanel.widgetAdded,((e,t)=>{if(this.tabGroupChanged||0===this.tabGroupModel.size)this.tabGroupChanged=!1,this.createTabsModel();else{const i=e.findTabBar(t.title),n=this.tabInfoLookup.get(t.title);this.tabGroupModel.get(i)!==(null==n?void 0:n.group)&&(n&&this.onTabClosed(n,t.title),this.onTabCreated(i,{index:i.titles.indexOf(t.title),title:t.title}))}})),this.connectToSignal(this.toDisposeOnDestroy,this.applicationShell.mainPanel.widgetRemoved,((e,t)=>{if(!(t instanceof n.TabBar)){const e=this.getOrRebuildModel(this.tabInfoLookup,t.title);this.onTabClosed(e,t.title),this.tabGroupChanged&&(this.tabGroupChanged=!1,this.createTabsModel())}}))}createTabsModel(){var e,t;const i=new Map;this.tabInfoLookup.clear(),this.disposableTabBarListeners.dispose(),this.applicationShell.mainAreaTabBars.forEach((e=>{this.attachListenersToTabBar(e);const t=this.createTabGroupDto(e);e.titles.forEach(((e,i)=>this.tabInfoLookup.set(e,{group:t,tab:t.tabs[i],tabIndex:i}))),i.set(e,t)})),i.size>0&&Array.from(i.values()).indexOf(this.currentActiveGroup)<0&&(this.currentActiveGroup=null!==(t=null===(e=this.tabInfoLookup.get(this.applicationShell.mainPanel.currentTitle))||void 0===e?void 0:e.group)&&void 0!==t?t:i.values().next().value,this.currentActiveGroup.isActive=!0),this.tabGroupModel=i,this.proxy.$acceptEditorTabModel(Array.from(this.tabGroupModel.values()))}createTabDto(e,t){const i=e.owner;return{id:this.createTabId(e,t),label:e.label,input:this.evaluateTabDtoInput(i),isActive:e.owner.isVisible,isPinned:e.className.includes(n.PINNED_CLASS),isDirty:n.Saveable.isDirty(i),isPreview:i instanceof r.EditorPreviewWidget&&i.isPreview}}createTabId(e,t){return`${t}~${e.owner.id}`}createTabGroupDto(e){var t;const i=this.tabGroupModel.get(e),n=null!==(t=null==i?void 0:i.groupId)&&void 0!==t?t:this.groupIdCounter++,o=e.titles.map((e=>this.createTabDto(e,n)));return{groupId:n,tabs:o,isActive:!1,viewColumn:1}}attachListenersToTabBar(e){e&&(e.titles.forEach((e=>{this.connectToSignal(this.disposableTabBarListeners,e.changed,this.onTabTitleChanged)})),this.connectToSignal(this.disposableTabBarListeners,e.tabMoved,this.onTabMoved),this.connectToSignal(this.disposableTabBarListeners,e.disposed,this.onTabGroupClosed))}evaluateTabDtoInput(e){return e instanceof r.EditorPreviewWidget?e.editor instanceof a.MonacoDiffEditor?{kind:2,original:(0,c.toUriComponents)(e.editor.originalModel.uri),modified:(0,c.toUriComponents)(e.editor.modifiedModel.uri)}:{kind:1,uri:(0,c.toUriComponents)(e.editor.uri.toString())}:e instanceof n.ViewContainer?{kind:7,viewType:e.id}:e instanceof l.TerminalWidget?{kind:8}:{kind:0}}connectToSignal(e,t,i){t.connect(i,this),e.push(s.Disposable.create((()=>t.disconnect(i))))}tabDtosEqual(e,t){return e.isActive===t.isActive&&e.isDirty===t.isDirty&&e.isPinned===t.isPinned&&e.isPreview===t.isPreview&&e.id===t.id}getOrRebuildModel(e,t){let i=e.get(t);return i||(this.createTabsModel(),i=e.get(t)),i}onTabCreated(e,t){const i=this.getOrRebuildModel(this.tabGroupModel,e);this.connectToSignal(this.disposableTabBarListeners,t.title.changed,this.onTabTitleChanged);const n=this.createTabDto(t.title,i.groupId);this.tabInfoLookup.set(t.title,{group:i,tab:n,tabIndex:t.index}),i.tabs.splice(t.index,0,n),this.proxy.$acceptTabOperation({kind:0,index:t.index,tabDto:n,groupId:i.groupId})}onTabTitleChanged(e){const t=this.getOrRebuildModel(this.tabInfoLookup,e);if(!t)return;const i=t.tab,n=this.createTabDto(e,t.group.groupId);n.isActive&&!t.group.isActive&&(t.group.isActive=!0,this.currentActiveGroup.isActive=!1,this.currentActiveGroup=t.group,this.proxy.$acceptTabGroupUpdate(t.group)),this.tabDtosEqual(i,n)||(t.group.tabs[t.tabIndex]=n,t.tab=n,this.proxy.$acceptTabOperation({kind:2,index:t.tabIndex,tabDto:n,groupId:t.group.groupId}))}onTabClosed(e,t){e.group.tabs.splice(e.tabIndex,1),this.tabInfoLookup.delete(t),this.updateTabIndices(e,e.tabIndex),this.proxy.$acceptTabOperation({kind:1,index:e.tabIndex,tabDto:this.createTabDto(t,e.group.groupId),groupId:e.group.groupId})}onTabMoved(e,t){const i=this.getOrRebuildModel(this.tabInfoLookup,t.title);i.tabIndex=t.toIndex;const n=this.createTabDto(t.title,i.group.groupId);i.group.tabs.splice(t.fromIndex,1),i.group.tabs.splice(t.toIndex,0,n),this.updateTabIndices(i,t.fromIndex),this.proxy.$acceptTabOperation({kind:3,index:t.toIndex,tabDto:n,groupId:i.group.groupId,oldIndex:t.fromIndex})}onTabGroupCreated(e){this.tabGroupChanged=!0}onTabGroupClosed(e){this.tabGroupChanged=!0}$moveTab(e,t,i,n){}updateTabIndices(e,t){for(const i of this.tabInfoLookup.values())i.group===e.group&&i.tabIndex>=t&&(i.tabIndex=i.group.tabs.indexOf(i.tab))}async $closeTab(e,t){const i=[];for(const t of e){const e=t.substring(t.indexOf("~")+1),n=this.applicationShell.getWidgetById(e);n&&i.push(n)}return await this.applicationShell.closeMany(i),!0}async $closeGroup(e,t){for(const t of e)e:for(const[e,i]of this.tabGroupModel)if(i.groupId===t){this.applicationShell.closeTabs(e);break e}return!0}dispose(){this.toDisposeOnDestroy.dispose(),this.disposableTabBarListeners.dispose()}}},42883:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TasksMainImpl=void 0;const n=i(16138),o=i(9825),r=i(46544),s=i(29274),a=i(82758),c=i(47028),l=i(467),d=new Map([[1,s.RevealKind.Always],[2,s.RevealKind.Silent],[3,s.RevealKind.Never],[s.RevealKind.Always,1],[s.RevealKind.Silent,2],[s.RevealKind.Never,3]]),u=new Map([[1,s.PanelKind.Shared],[2,s.PanelKind.Dedicated],[3,s.PanelKind.New],[s.PanelKind.Shared,1],[s.PanelKind.Dedicated,2],[s.PanelKind.New,3]]);t.TasksMainImpl=class{constructor(e,t){this.taskProviders=new Map,this.toDispose=new o.DisposableCollection,this.proxy=e.getProxy(n.MAIN_RPC_CONTEXT.TASKS_EXT),this.taskProviderRegistry=t.get(r.TaskProviderRegistry),this.taskResolverRegistry=t.get(r.TaskResolverRegistry),this.taskWatcher=t.get(a.TaskWatcher),this.taskService=t.get(c.TaskService),this.taskDefinitionRegistry=t.get(l.TaskDefinitionRegistry),this.toDispose.push(this.taskWatcher.onTaskCreated((e=>{this.proxy.$onDidStartTask({id:e.taskId,task:this.fromTaskConfiguration(e.config)},e.terminalId)}))),this.toDispose.push(this.taskWatcher.onTaskExit((e=>{this.proxy.$onDidEndTask(e.taskId)}))),this.toDispose.push(this.taskWatcher.onDidStartTaskProcess((e=>{void 0!==e.processId&&this.proxy.$onDidStartTaskProcess(e.processId,{id:e.taskId,task:this.fromTaskConfiguration(e.config)})}))),this.toDispose.push(this.taskWatcher.onDidEndTaskProcess((e=>{void 0!==e.code&&this.proxy.$onDidEndTaskProcess(e.code,e.taskId)}))),this.$taskExecutions().then((e=>{e.length>0&&this.proxy.$initLoadedTasks(e)}))}dispose(){this.toDispose.dispose()}$registerTaskProvider(e,t){const i=this.createTaskProvider(e),n=this.createTaskResolver(e),r=new o.DisposableCollection(this.taskProviderRegistry.register(t,i,e),this.taskResolverRegistry.registerTaskResolver(t,n),o.Disposable.create((()=>this.taskProviders.delete(e))));this.taskProviders.set(e,r),this.toDispose.push(r)}$unregister(e){const t=this.taskProviders.get(e);t&&t.dispose()}async $fetchTasks(e,t){if(e&&!e.startsWith("2."))return[];const i=this.taskService.startUserAction(),[n,o]=await Promise.all([this.taskService.getConfiguredTasks(i),this.taskService.getProvidedTasks(i)]),r=[];for(const e of[n,o])for(const i of e)t&&(this.taskDefinitionRegistry.getDefinition(i)?i._source!==t:i.type!==t)||r.push(this.fromTaskConfiguration(i));return r}async $executeTask(e){const t=this.toTaskConfiguration(e),i=await this.taskService.runTask(t);if(i)return{id:i.taskId,task:this.fromTaskConfiguration(i.config)}}async $taskExecutions(){return(await this.taskService.getRunningTasks()).map((e=>({id:e.taskId,task:this.fromTaskConfiguration(e.config)})))}$terminateTask(e){this.taskService.kill(e)}async $customExecutionComplete(e,t){this.taskService.customExecutionComplete(e,t)}createTaskProvider(e){return{provideTasks:()=>this.proxy.$provideTasks(e).then((e=>e.map((e=>this.toTaskConfiguration(e)))))}}createTaskResolver(e){return{resolveTask:t=>this.proxy.$resolveTask(e,this.fromTaskConfiguration(t)).then((e=>this.toTaskConfiguration(e)))}}toTaskConfiguration(e){const{group:t,presentation:i,scope:n,source:o,runOptions:r,...s}=null!=e?e:{},a={};return i&&(a.presentation=this.convertTaskPresentation(i)),t&&(a.group={kind:t.kind,isDefault:t.isDefault}),{...s,...a,runOptions:r,_scope:n,_source:o}}fromTaskConfiguration(e){const{group:t,presentation:i,_scope:n,_source:o,...r}=e,s={};return i&&(s.presentation=this.convertTaskPresentation(i)),"build"===t||"test"===t?s.group={kind:t,isDefault:!1}:"object"==typeof t&&(s.group=t),{...r,...s,scope:n,source:o}}convertTaskPresentation(e){if(e){const{reveal:t,panel:i,...n}=e,o={};return t&&(o.reveal=d.get(t)),i&&(o.panel=u.get(i)),{...n,...o}}}}},24125:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TerminalServiceMainImpl=void 0;const n=i(87361),o=i(21723),r=i(24227),s=i(16138),a=i(51138),c=i(37663),l=i(71401),d=i(30970),u=i(59291),h=i(94842),p=i(9825),g=i(81602);t.TerminalServiceMainImpl=class{constructor(e,t){this.terminalLinkProviders=[],this.toDispose=new a.DisposableCollection,this.terminals=t.get(r.TerminalService),this.pluginTerminalRegistry=t.get(h.PluginTerminalRegistry),this.hostedPluginSupport=t.get(g.HostedPluginSupport),this.shell=t.get(n.ApplicationShell),this.shellTerminalServer=t.get(c.ShellTerminalServerProxy),this.extProxy=e.getProxy(s.MAIN_RPC_CONTEXT.TERMINAL_EXT),this.toDispose.push(this.terminals.onDidCreateTerminal((e=>this.trackTerminal(e))));for(const e of this.terminals.all)this.trackTerminal(e);if(this.toDispose.push(this.terminals.onDidChangeCurrentTerminal((()=>this.updateCurrentTerminal()))),this.updateCurrentTerminal(),this.shellTerminalServer.collections.size>0){const e=[...this.shellTerminalServer.collections.entries()].map((e=>[e[0],[...e[1].map.entries()]]));this.extProxy.$initEnvironmentVariableCollections(e)}this.pluginTerminalRegistry.startCallback=e=>this.startProfile(e),t.bind(l.TerminalLinkProvider).toDynamicValue((()=>this))}async startProfile(e){return await this.hostedPluginSupport.activateByTerminalProfile(e),this.extProxy.$startProfile(e,p.CancellationToken.None)}$setEnvironmentVariableCollection(e,t,i){i?this.shellTerminalServer.setCollection(e,t,i):this.shellTerminalServer.deleteCollection(e)}dispose(){this.toDispose.dispose()}updateCurrentTerminal(){const{currentTerminal:e}=this.terminals;this.extProxy.$currentTerminalChanged(e&&e.id)}async trackTerminal(e){let t=e.title.label;this.extProxy.$terminalCreated(e.id,t);const i=()=>{t!==e.title.label&&(t=e.title.label,this.extProxy.$terminalNameChanged(e.id,t))};e.title.changed.connect(i),this.toDispose.push(a.Disposable.create((()=>e.title.changed.disconnect(i))));const n=()=>e.processId.then((t=>this.extProxy.$terminalOpened(e.id,t,e.terminalId,e.dimensions.cols,e.dimensions.rows)),(()=>{}));n(),this.toDispose.push(e.onDidOpen((()=>n()))),this.toDispose.push(e.onTerminalDidClose((e=>this.extProxy.$terminalClosed(e.id,e.exitStatus)))),this.toDispose.push(e.onSizeChanged((({cols:t,rows:i})=>{this.extProxy.$terminalSizeChanged(e.id,t,i)}))),this.toDispose.push(e.onData((t=>{this.extProxy.$terminalOnInput(e.id,t),this.extProxy.$terminalStateChanged(e.id)})))}$write(e,t){const i=this.terminals.getById(e);i&&i.write(t)}$resize(e,t,i){const n=this.terminals.getById(e);n&&n.resize(t,i)}async $createTerminal(e,t,i,n){const o=await this.terminals.newTerminal({id:e,title:t.name,iconClass:(0,u.getIconClass)(t),shellPath:t.shellPath,shellArgs:t.shellArgs,cwd:t.cwd?new d.URI(t.cwd):void 0,env:t.env,strictEnv:t.strictEnv,destroyTermOnClose:!0,useServerTitle:!1,attributes:t.attributes,hideFromUser:t.hideFromUser,location:this.getTerminalLocation(t,i),isPseudoTerminal:n,isTransient:t.isTransient});return t.message&&o.writeLine(t.message),o.start(),o.id}getTerminalLocation(e,t){if("number"==typeof e.location&&Object.values(o.TerminalLocation).includes(e.location))return e.location;if(e.location&&"object"==typeof e.location){if("parentTerminal"in e.location){if(!t)throw new Error("parentTerminal is set but no parentId is provided");return{parentTerminal:t}}return e.location}}$sendText(e,t,i){const n=this.terminals.getById(e);n&&(t=t.replace(/\r?\n/g,"\r"),i&&"\r"!==t.charAt(t.length-1)&&(t+="\r"),n.sendText(t))}$show(e,t){const i=this.terminals.getById(e);if(i){const e={};t&&(e.mode="reveal"),this.terminals.open(i,e)}}$hide(e){const t=this.terminals.getById(e);if(t&&t.isVisible){const e=this.shell.getAreaFor(t);e&&this.shell.collapsePanel(e)}}$dispose(e){const t=this.terminals.getById(e);t&&t.dispose()}$setName(e,t){var i;null===(i=this.terminals.getById(e))||void 0===i||i.setTitle(t)}$sendTextByTerminalId(e,t,i){const n=this.terminals.getByTerminalId(e);n&&(t=t.replace(/\r?\n/g,"\r"),i&&"\r"!==t.charAt(t.length-1)&&(t+="\r"),n.sendText(t))}$writeByTerminalId(e,t){const i=this.terminals.getByTerminalId(e);i&&i.write(t)}$resizeByTerminalId(e,t,i){const n=this.terminals.getByTerminalId(e);n&&n.resize(t,i)}$showByTerminalId(e,t){const i=this.terminals.getByTerminalId(e);if(i){const e={};t&&(e.mode="reveal"),this.terminals.open(i,e)}}$hideByTerminalId(e){const t=this.terminals.getByTerminalId(e);if(t&&t.isVisible){const e=this.shell.getAreaFor(t);e&&this.shell.collapsePanel(e)}}$disposeByTerminalId(e,t){const i=this.terminals.getByTerminalId(e);if(i){if(t)return void i.waitOnExit(t);i.dispose()}}$setNameByTerminalId(e,t){var i;null===(i=this.terminals.getByTerminalId(e))||void 0===i||i.setTitle(t)}async $registerTerminalLinkProvider(e){this.terminalLinkProviders.push(e)}async $unregisterTerminalLinkProvider(e){const t=this.terminalLinkProviders.indexOf(e);t>-1&&this.terminalLinkProviders.splice(t,1)}async provideLinks(e,t,i){return this.terminalLinkProviders.length<1?[]:(await this.extProxy.$provideTerminalLinks(e,t.id,null!=i?i:p.CancellationToken.None)).map((e=>({...e,handle:()=>this.extProxy.$handleTerminalLink(e)})))}}},96625:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextEditorPropertiesMain=t.TextEditorMain=void 0;const n=i(39539),o=i(51138),r=i(16138),s=i(9825),a=i(14020),c=i(92147);class l{constructor(e,t,i){this.id=e,this.model=t,this.onPropertiesChangedEmitter=new s.Emitter,this.toDispose=new o.DisposableCollection(o.Disposable.create((()=>this.properties=void 0)),this.onPropertiesChangedEmitter),this.toDisposeOnEditor=new o.DisposableCollection,this.toDispose.push(this.model.onDidChangeOptions((()=>this.updateProperties(void 0)))),this.setEditor(i),this.updateProperties(void 0)}dispose(){this.toDispose.dispose()}updateProperties(e){this.setProperties(d.readFromEditor(this.properties,this.model,this.editor),e)}setProperties(e,t){const i=e.generateDelta(this.properties,t);this.properties=e,i&&this.onPropertiesChangedEmitter.fire(i)}setEditor(e){if(this.editor!==e&&(this.toDisposeOnEditor.dispose(),this.toDispose.push(this.toDisposeOnEditor),this.editor=e,this.toDisposeOnEditor.push(o.Disposable.create((()=>this.editor=void 0))),this.editor)){const e=this.editor.getControl();this.toDisposeOnEditor.push(this.editor.onSelectionChanged((e=>{this.updateProperties()}))),this.toDisposeOnEditor.push(e.onDidChangeModel((()=>{this.setEditor(void 0)}))),this.toDisposeOnEditor.push(e.onDidChangeCursorSelection((e=>{this.updateProperties(e.source)}))),this.toDisposeOnEditor.push(e.onDidChangeConfiguration((()=>{this.updateProperties()}))),this.toDisposeOnEditor.push(e.onDidLayoutChange((()=>{this.updateProperties()}))),this.toDisposeOnEditor.push(e.onDidScrollChange((()=>{this.updateProperties()}))),this.updateProperties()}}getId(){return this.id}getModel(){return this.model}getProperties(){return this.properties}get onPropertiesChangedEvent(){return this.onPropertiesChangedEmitter.event}setSelections(e){if(this.editor)return void this.editor.getControl().setSelections(e);const t=e.map(l.toMonacoSelections);this.setProperties(new d(t,this.properties.options,this.properties.visibleRanges),void 0)}setConfiguration(e){if(this.setIndentConfiguration(e),this.editor){if(e.cursorStyle){const t=(0,a.cursorStyleToString)(e.cursorStyle);this.editor.getControl().updateOptions({cursorStyle:t})}if(void 0!==e.lineNumbers){let t;switch(e.lineNumbers){case c.TextEditorLineNumbersStyle.On:t="on";break;case c.TextEditorLineNumbersStyle.Relative:t="relative";break;default:t="off"}this.editor.getControl().updateOptions({lineNumbers:t})}}}setIndentConfiguration(e){if("auto"===e.tabSize||"auto"===e.insertSpaces){const t=this.model.getOptions();let i=t.insertSpaces,n=t.tabSize;return"auto"!==e.insertSpaces&&void 0!==e.insertSpaces&&(i=e.insertSpaces),"auto"!==e.tabSize&&void 0!==e.tabSize&&(n=e.tabSize),void this.model.detectIndentation(i,n)}const t={};void 0!==e.insertSpaces&&(t.insertSpaces=e.insertSpaces),void 0!==e.tabSize&&(t.tabSize=e.tabSize),this.model.updateOptions(t)}revealRange(e,t){if(this.editor)switch(t){case r.TextEditorRevealType.Default:this.editor.getControl().revealRange(e,n.editor.ScrollType.Smooth);break;case r.TextEditorRevealType.InCenter:this.editor.getControl().revealRangeInCenter(e,n.editor.ScrollType.Smooth);break;case r.TextEditorRevealType.InCenterIfOutsideViewport:this.editor.getControl().revealRangeInCenterIfOutsideViewport(e,n.editor.ScrollType.Smooth);break;case r.TextEditorRevealType.AtTop:this.editor.getControl().revealRangeAtTop(e,n.editor.ScrollType.Smooth);break;default:console.warn(`Unknown revealType: ${t}`)}}applyEdits(e,t,i){if(this.model.getVersionId()!==e)return!1;if(!this.editor)return!1;i.setEndOfLine===c.EndOfLine.CRLF?this.model.setEOL(n.editor.EndOfLineSequence.CRLF):i.setEndOfLine===c.EndOfLine.LF&&this.model.setEOL(n.editor.EndOfLineSequence.LF);const o=[];for(const e of t){const{range:t,text:i}=e;(t||i)&&(t&&t.startLineNumber===t.endLineNumber&&t.startColumn===t.endColumn&&!e.text||o.push({range:t?n.Range.lift(t):this.editor.getControl().getModel().getFullModelRange(),text:i||null,forceMoveMarkers:e.forceMoveMarkers}))}return i.undoStopBefore&&this.editor.getControl().pushUndoStop(),this.editor.getControl().executeEdits("MainThreadTextEditor",o),i.undoStopAfter&&this.editor.getControl().pushUndoStop(),!0}insertSnippet(e,t,i){var o;const r=null===(o=this.editor)||void 0===o?void 0:o.getControl().getContribution("snippetController2");if(!r||!this.editor)return!1;const s=t.map((e=>new n.Selection(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn)));return this.editor.getControl().setSelections(s),this.editor.focus(),r.insert(e,0,0,i.undoStopBefore,i.undoStopAfter),!0}setDecorations(e,t){this.editor&&this.editor.getControl().setDecorationsByType("Plugin decorations",e,t.map((e=>Object.assign(e,{color:void 0}))))}setDecorationsFast(e,t){if(!this.editor)return;const i=[],o=Math.floor(t.length/4);for(let e=0;e<o;e++)i[e]=new n.Range(t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]);this.editor.getControl().setDecorationsByTypeFast(e,i)}static toMonacoSelections(e){return new n.Selection(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}}t.TextEditorMain=l;class d{constructor(e,t,i){this.selections=e,this.options=t,this.visibleRanges=i}generateDelta(e,t){const i={options:void 0,selections:void 0,visibleRanges:void 0};if(e&&d.selectionsEqual(e.selections,this.selections)||(i.selections={selections:this.selections,source:t}),e&&d.optionsEqual(e.options,this.options)||(i.options=this.options),e&&d.rangesEqual(e.visibleRanges,this.visibleRanges)||(i.visibleRanges=this.visibleRanges),i.selections||i.visibleRanges||i.options)return i}static readFromEditor(e,t,i){const n=d.getSelectionsFromEditor(e,i),o=d.getOptionsFromEditor(e,t,i),r=d.getVisibleRangesFromEditor(e,i);return new d(n,o,r)}static getSelectionsFromEditor(e,t){let i;return t&&(i=t.getControl().getSelections()||void 0),!i&&e&&(i=e.selections),i||(i=[new n.Selection(1,1,1,1)]),i}static getOptionsFromEditor(e,t,i){if(t.isDisposed())return e.options;let o,r;if(i){const e=i.getControl().getOptions(),t=e.get(n.editor.EditorOption.lineNumbers);switch(o=e.get(n.editor.EditorOption.cursorStyle),t.renderType){case n.editor.RenderLineNumbersType.Off:r=c.TextEditorLineNumbersStyle.Off;break;case n.editor.RenderLineNumbersType.Relative:r=c.TextEditorLineNumbersStyle.Relative;break;default:r=c.TextEditorLineNumbersStyle.On}}else e?(o=e.options.cursorStyle,r=e.options.lineNumbers):(o=a.TextEditorCursorStyle.Line,r=c.TextEditorLineNumbersStyle.On);const s=t.getOptions();return{insertSpaces:s.insertSpaces,tabSize:s.tabSize,cursorStyle:o,lineNumbers:r}}static getVisibleRangesFromEditor(e,t){return t?t.getControl().getVisibleRanges():[]}static selectionsEqual(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!e[i].equalsSelection(t[i]))return!1;return!0}static optionsEqual(e,t){return!(e&&!t||!e&&t)&&(!e&&!t||e.tabSize===t.tabSize&&e.insertSpaces===t.insertSpaces&&e.cursorStyle===t.cursorStyle&&e.lineNumbers===t.lineNumbers)}static rangesEqual(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!e[i].equalsRange(t[i]))return!1;return!0}}t.TextEditorPropertiesMain=d},14784:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.EditorModelService=void 0;const s=i(9825),a=i(70801),c=i(731),l=i(77582),d=i(40824);let u=class{constructor(e,t){this.modelModeChangedEmitter=new s.Emitter,this.onModelRemovedEmitter=new s.Emitter,this.modelDirtyEmitter=new s.Emitter,this.modelSavedEmitter=new s.Emitter,this.onModelWillSavedEmitter=new s.Emitter,this.onModelDirtyChanged=this.modelDirtyEmitter.event,this.onModelSaved=this.modelSavedEmitter.event,this.onModelModeChanged=this.modelModeChangedEmitter.event,this.onModelRemoved=this.onModelRemovedEmitter.event,this.onModelWillSave=this.onModelWillSavedEmitter.event,this.monacoModelService=e,e.models.forEach((e=>this.modelCreated(e))),e.onDidCreate(this.modelCreated,this),t.onDidCloseTextDocument((e=>{setTimeout((()=>{this.onModelRemovedEmitter.fire(e)}),1)}))}modelCreated(e){e.textEditorModel.onDidChangeLanguage((t=>{this.modelModeChangedEmitter.fire({model:e,oldModeId:t.oldLanguage})})),e.onDidSaveModel((t=>{this.modelSavedEmitter.fire(e)})),e.onDirtyChanged((t=>{this.modelDirtyEmitter.fire(e)})),e.onWillSaveModel((e=>{this.onModelWillSavedEmitter.fire(e)}))}get onModelAdded(){return this.monacoModelService.onDidCreate}getModels(){return this.monacoModelService.models}async saveAll(e){const t=[];for(const i of this.monacoModelService.models){const{uri:n}=i.textEditorModel;i.dirty&&(e||n.scheme!==d.Schemes.untitled)&&t.push((async()=>{try{return await i.save(),!0}catch(e){return console.error("Failed to save ",n.toString(),e),!1}})())}return(await Promise.all(t)).reduce(((e,t)=>e&&t),!0)}async createModelReference(e){return this.monacoModelService.createModelReference(e)}};u=n([(0,a.injectable)(),r(0,(0,a.inject)(c.MonacoTextModelService)),r(1,(0,a.inject)(l.MonacoWorkspace)),o("design:paramtypes",[c.MonacoTextModelService,l.MonacoWorkspace])],u),t.EditorModelService=u},92637:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextEditorsMainImpl=void 0;const n=i(10433),o=i(16138),r=i(51138),s=i(28929),a=i(29277),c=i(40824),l=i(20820),d=i(39539),u=i(5993);t.TextEditorsMainImpl=class{constructor(e,t,i,n,s){this.editorsAndDocuments=e,this.documents=t,this.bulkEditService=n,this.monacoEditorService=s,this.toDispose=new r.DisposableCollection,this.editorsToDispose=new Map,this.fileEndpoint=new l.Endpoint({path:"file"}).getRestUrl(),this.proxy=i.getProxy(o.MAIN_RPC_CONTEXT.TEXT_EDITORS_EXT),this.toDispose.push(e),this.toDispose.push(e.onTextEditorAdd((e=>e.forEach(this.onTextEditorAdd,this)))),this.toDispose.push(e.onTextEditorRemove((e=>e.forEach(this.onTextEditorRemove,this))))}dispose(){this.toDispose.dispose()}onTextEditorAdd(e){const t=e.getId(),i=new r.DisposableCollection(e.onPropertiesChangedEvent((e=>{this.proxy.$acceptEditorPropertiesChanged(t,e)})),r.Disposable.create((()=>this.editorsToDispose.delete(t))));this.editorsToDispose.set(t,i),this.toDispose.push(i)}onTextEditorRemove(e){const t=this.editorsToDispose.get(e);t&&t.dispose()}$tryShowTextDocument(e,t){return this.documents.$tryShowDocument(e,t)}$trySetOptions(e,t){return this.editorsAndDocuments.getEditor(e)?(this.editorsAndDocuments.getEditor(e).setConfiguration(t),Promise.resolve()):Promise.reject((0,s.disposed)(`TextEditor: ${e}`))}$trySetSelections(e,t){return this.editorsAndDocuments.getEditor(e)?(this.editorsAndDocuments.getEditor(e).setSelections(t),Promise.resolve()):Promise.reject((0,s.disposed)(`TextEditor: ${e}`))}$tryRevealRange(e,t,i){return this.editorsAndDocuments.getEditor(e)?(this.editorsAndDocuments.getEditor(e).revealRange(new d.Range(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn),i),Promise.resolve()):Promise.reject((0,s.disposed)(`TextEditor(${e})`))}$tryApplyEdits(e,t,i,n){return this.editorsAndDocuments.getEditor(e)?Promise.resolve(this.editorsAndDocuments.getEditor(e).applyEdits(t,i,n)):Promise.reject((0,s.disposed)(`TextEditor(${e})`))}async $tryApplyWorkspaceEdit(e,t){const i=(0,a.toMonacoWorkspaceEdit)(e);try{const e=u.ResourceEdit.convert(i),{success:n}=await this.bulkEditService.apply(e,{respectAutoSaveConfig:null==t?void 0:t.isRefactoring});return n}catch{return!1}}$tryInsertSnippet(e,t,i,n){return this.editorsAndDocuments.getEditor(e)?Promise.resolve(this.editorsAndDocuments.getEditor(e).insertSnippet(t,i,n)):Promise.reject((0,s.disposed)(`TextEditor(${e})`))}$registerTextEditorDecorationType(e,t){this.injectRemoteUris(t),this.monacoEditorService.registerDecorationType("Plugin decoration",e,t),this.toDispose.push(r.Disposable.create((()=>this.$removeTextEditorDecorationType(e))))}injectRemoteUris(e){e.before&&(e.before.contentIconPath=this.toRemoteUri(e.before.contentIconPath)),e.after&&(e.after.contentIconPath=this.toRemoteUri(e.after.contentIconPath)),"gutterIconPath"in e&&(e.gutterIconPath=this.toRemoteUri(e.gutterIconPath)),"dark"in e&&e.dark&&this.injectRemoteUris(e.dark),"light"in e&&e.light&&this.injectRemoteUris(e.light)}toRemoteUri(e){return e&&"file"===e.scheme?(0,c.theiaUritoUriComponents)(this.fileEndpoint.withQuery(n.URI.revive(e).toString())):e}$removeTextEditorDecorationType(e){this.monacoEditorService.removeDecorationType(e)}$tryHideEditor(e){return this.editorsAndDocuments.hideEditor(e)}$trySetDecorations(e,t,i){return this.editorsAndDocuments.getEditor(e)?(this.editorsAndDocuments.getEditor(e).setDecorations(t,i),Promise.resolve()):Promise.reject((0,s.disposed)(`TextEditor(${e})`))}$trySetDecorationsFast(e,t,i){return this.editorsAndDocuments.getEditor(e)?(this.editorsAndDocuments.getEditor(e).setDecorationsFast(t,i),Promise.resolve()):Promise.reject((0,s.disposed)(`TextEditor(${e})`))}$saveAll(e){return this.editorsAndDocuments.saveAll(e)}}},23794:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(56090),o={"accounts-view-bar-icon":"account","breakpoints-activate":"activate-breakpoints","breakpoints-remove-all":"close-all","breakpoints-view-icon":"debug-alt","callhierarchy-incoming":"call-incoming","callhierarchy-outgoing":"call-outgoing","callstack-view-icon":"debug-alt","callstack-view-session":"bug","comments-view-icon":"comment-discussion","debug-breakpoint":"debug-breakpoint","debug-breakpoint-conditional":"debug-breakpoint-conditional","debug-breakpoint-conditional-disabled":"debug-breakpoint-conditional-disabled","debug-breakpoint-conditional-verified":"debug-breakpoint-conditional-unverified","debug-breakpoint-data":"debug-breakpoint-data","debug-breakpoint-data-disabled":"debug-breakpoint-data-disabled","debug-breakpoint-data-unverified":"debug-breakpoint-data-unverified","debug-breakpoint-disabled":"debug-breakpoint-disabled","debug-breakpoint-function":"debug-breakpoint-function","debug-breakpoint-function-disabled":"debug-breakpoint-function-disabled","debug-breakpoint-function-unverified":"debug-breakpoint-function-unverified","debug-breakpoint-log":"debug-breakpoint-log","debug-breakpoint-log-disabled":"debug-breakpoint-log-disabled","debug-breakpoint-log-unverified":"debug-breakpoint-log-unverified","debug-breakpoint-unsupported":"debug-breakpoint-unsupported","debug-breakpoint-unverified":"debug-breakpoint-unverified","debug-collapse-all":"collapse-all","debug-configure":"gear","debug-console-clear-all":"clear-all","debug-console-evaluation-input":"arrow-small-right","debug-console-evaluation-prompt":"chevron-right","debug-console-view-icon":"debug-console","debug-continue":"debug-continue","debug-disconnect":"debug-disconnect","debug-gripper":"gripper","debug-hint":"debug-hint","debug-pause":"debug-pause","debug-restart":"debug-restart","debug-restart-frame":"debug-restart-frame","debug-reverse-continue":"debug-reverse-continue","debug-stackframe":"debug-stackframe","debug-stackframe-focused":"debug-stackframe-focused","debug-start":"debug-start","debug-step-back":"debug-step-back","debug-step-into":"debug-step-into","debug-step-out":"debug-step-out","debug-step-over":"debug-step-over","debug-stop":"debug-stop","default-view-icon":"window","diff-editor-next-change":"arrow-down","diff-editor-previous-change":"arrow-up","diff-editor-toggle-whitespace":"whitespace","diff-insert":"add","diff-remove":"remove","diff-review-close":"close","diff-review-insert":"add","diff-review-remove":"remove","explorer-view-icon":"files","extensions-clear-search-results":"clear-all","extensions-configure-recommended":"pencil","extensions-filter":"filter","extensions-info-message":"info","extensions-install-count":"cloud-download","extensions-install-local-in-remote":"cloud-download","extensions-install-workspace-recommended":"cloud-download","extensions-manage":"gear","extensions-rating":"star","extensions-refresh":"refresh","extensions-remote":"remote","extensions-star-empty":"star-empty","extensions-star-full":"star-full","extensions-star-half":"star-half","extensions-sync-enabled":"sync","extensions-sync-ignored":"sync-ignored","extensions-view-icon":"extensions","extensions-warning-message":"warning","find-collapsed":"chevron-right","find-expanded":"chevron-down","find-next-match":"arrow-down","find-previous-match":"arrow-up","find-replace":"replace","find-replace-all":"replace-all","find-selection":"selection","folding-collapsed":"chevron-right","folding-expanded":"chevron-down","getting-started-beginner":"lightbulb","getting-started-codespaces":"github","getting-started-item-checked":"pass-filled","getting-started-item-unchecked":"circle-large-outline","getting-started-setup":"heart","goto-next-location":"arrow-down","goto-previous-location":"arrow-up","keybindings-add":"add","keybindings-edit":"edit","keybindings-record-keys":"record-keys","keybindings-sort":"sort-precedence","loaded-scripts-view-icon":"debug-alt","marker-navigation-next":"chevron-down","marker-navigation-previous":"chevron-up","markers-view-filter":"filter","markers-view-icon":"warning","markers-view-multi-line-collapsed":"chevron-down","markers-view-multi-line-expanded":"chevron-up","notebook-clear":"clear-all","notebook-collapsed":"chevron-right","notebook-delete-cell":"trash","notebook-edit":"pencil","notebook-execute":"play","notebook-execute-all":"run-all","notebook-expanded":"chevron-down","notebook-kernel-configure":"settings-gear","notebook-kernel-select":"server-environment","notebook-mimetype":"code","notebook-move-down":"arrow-down","notebook-move-up":"arrow-up","notebook-open-as-text":"file-code","notebook-render-output":"preview","notebook-revert":"discard","notebook-split-cell":"split-vertical","notebook-state-error":"error","notebook-state-success":"check","notebook-stop":"primitive-square","notebook-stop-edit":"check","notebook-unfold":"unfold","notifications-clear":"close","notifications-clear-all":"clear-all","notifications-collapse":"chevron-down","notifications-configure":"gear","notifications-expand":"chevron-up","notifications-hide":"chevron-down","open-editors-view-icon":"book","outline-view-icon":"symbol-class","output-view-icon":"output","panel-close":"close","panel-maximize":"chevron-up","panel-restore":"chevron-down","parameter-hints-next":"chevron-down","parameter-hints-previous":"chevron-up","ports-forward-icon":"plus","ports-open-browser-icon":"globe","ports-stop-forward-icon":"x","ports-view-icon":"plug","preferences-clear-input":"clear-all","preferences-open-settings":"go-to-file","private-ports-view-icon":"lock","public-ports-view-icon":"eye","refactor-preview-view-icon":"lightbulb","remote-explorer-documentation":"book","remote-explorer-feedback":"twitter","remote-explorer-get-started":"star","remote-explorer-report-issues":"comment","remote-explorer-review-issues":"issues","remote-explorer-view-icon":"remote-explorer","review-comment-collapse":"chevron-up","run-view-icon":"debug-alt","search-clear-results":"clear-all","search-collapse-results":"collapse-all","search-details":"ellipsis","search-expand-results":"expand-all","search-hide-replace":"chevron-right","search-new-editor":"new-file","search-refresh":"refresh","search-remove":"close","search-replace":"replace","search-replace-all":"replace-all","search-show-context":"list-selection","search-show-replace":"chevron-down","search-stop":"search-stop","search-view-icon":"search","settings-add":"add","settings-discard":"discard","settings-edit":"edit","settings-folder-dropdown":"triangle-down","settings-group-collapsed":"chevron-right","settings-group-expanded":"chevron-down","settings-more-action":"gear","settings-remove":"close","settings-sync-view-icon":"sync","settings-view-bar-icon":"settings-gear","source-control-view-icon":"source-control","suggest-more-info":"chevron-right","tasks-list-configure":"gear","tasks-remove":"close","terminal-kill":"trash","terminal-new":"add","terminal-rename":"gear","terminal-view-icon":"terminal","test-view-icon":"beaker","testing-cancel-icon":"close","testing-debug-icon":"debug-alt","testing-error-icon":"warning","testing-failed-icon":"close","testing-passed-icon":"pass","testing-queued-icon":"watch","testing-run-all-icon":"run-all","testing-run-icon":"run","testing-show-as-list-icon":"list-tree","testing-skipped-icon":"debug-step-over","testing-unset-icon":"circle-outline","timeline-open":"history","timeline-pin":"pin","timeline-refresh":"refresh","timeline-unpin":"pinned","timeline-view-icon":"history","variables-view-icon":"debug-alt","view-pane-container-collapsed":"chevron-right","view-pane-container-expanded":"chevron-down","watch-expressions-add":"add","watch-expressions-add-function-breakpoint":"add","watch-expressions-remove-all":"close-all","watch-view-icon":"debug-alt","widget-close":"close"},r=n.ThemeIcon.asCSSSelector,s=n.ThemeIcon.asClassName,a=n.ThemeIcon.asClassNameArray;function c(e){var t;const i=null!==(t=o[e.id])&&void 0!==t?t:e.id;return{...e,id:i}}Object.assign(n.ThemeIcon,{asCSSSelector:e=>r(c(e)),asClassName:e=>s(c(e)),asClassNameArray:e=>a(c(e))})},5563:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThemingMainImpl=void 0;const n=i(16138);t.ThemingMainImpl=class{constructor(e,t){this.proxy=e.getProxy(n.MAIN_RPC_CONTEXT.THEMING_EXT),this.themeChangeListener=t.onDidColorThemeChange((e=>this.proxy.$onColorThemeChange(e.newTheme.type))),this.proxy.$onColorThemeChange(t.getCurrentTheme().type)}dispose(){this.themeChangeListener.dispose()}}},7966:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimelineMainImpl=void 0;const n=i(16138),o=i(64514),r=i(9825);t.TimelineMainImpl=class{constructor(e,t){this.providerEmitters=new Map,this.proxy=e.getProxy(n.MAIN_RPC_CONTEXT.TIMELINE_EXT),this.timelineService=t.get(o.TimelineService)}async $registerTimelineProvider(e){const t=this.proxy,i=this.providerEmitters;let n=i.get(e.id);void 0===n&&(n=new r.Emitter,i.set(e.id,n)),this.timelineService.registerTimelineProvider({...e,onDidChange:n.event,provideTimeline:(i,n,o)=>t.$getTimeline(e.id,i,n,o),dispose(){i.delete(e.id),n&&n.dispose()}})}async $unregisterTimelineProvider(e){this.timelineService.unregisterTimelineProvider(e)}async $fireTimelineChanged(e){const t=this.providerEmitters.get(e.id);t&&t.fire(e)}}},19290:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ViewColumnService=void 0;const s=i(70801),a=i(18894),c=i(67126),l=i(97347);let d=class{constructor(e){this.shell=e,this.columnValues=new Map,this.viewColumnIds=new Map,this.onViewColumnChangedEmitter=new a.Emitter;let t=new Map;const i=async()=>{await new Promise((e=>setTimeout(e))),this.updateViewColumns(),this.viewColumnIds.forEach(((e,i)=>{e.forEach((e=>{t.has(e)&&t.get(e)===i||this.onViewColumnChangedEmitter.fire({id:e,viewColumn:i})}))})),t=new Map(this.columnValues.entries())};this.shell.mainPanel.widgetAdded.connect((()=>i())),this.shell.mainPanel.widgetRemoved.connect((()=>i()))}get onViewColumnChanged(){return this.onViewColumnChangedEmitter.event}updateViewColumns(){this.columnValues.clear(),this.viewColumnIds.clear();const e=new Map,t=new Map;for(const i of(0,l.toArray)(this.shell.mainPanel.tabBars())){if(!i.node.style.top||!i.node.style.left)continue;const n=parseInt(i.node.style.top),o=parseInt(i.node.style.left),r=e.get(n)||new Set;r.add(o),e.set(n,r);const s=t.get(o)||new Map;s.set(n,i),t.set(o,s)}const i=e.get([...e.keys()].sort()[0]);if(!i)return;const n=[...i.keys()].sort();for(let e=0;e<n.length;e++){const i=t.get(n[e]);if(!i)break;const o=[...i.keys()].sort();let r=Math.min(e,2);for(let e=0;e<o.length;e++){const t=i.get(o[e]);if(!t)break;this.setViewColumn(t,r),r<7&&(r+=3)}}}setViewColumn(e,t){const i=[];for(const n of e.titles){const e=n.owner.id;i.push(e),this.columnValues.set(e,t)}this.viewColumnIds.set(t,i)}getViewColumnIds(e){return this.viewColumnIds.get(e)||[]}getViewColumn(e){return this.columnValues.get(e)}hasViewColumn(e){return this.columnValues.has(e)}viewColumnsSize(){return this.viewColumnIds.size}};d=n([(0,s.injectable)(),r(0,(0,s.inject)(c.ApplicationShell)),o("design:paramtypes",[c.ApplicationShell])],d),t.ViewColumnService=d},20607:function(e,t,i){"use strict";var n,o=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.DnDFileContentStore=void 0;const r=i(70801);let s=n=class{constructor(){this.files=new Map}addFile(e){const t=(n.id++).toString();return this.files.set(t,e),t}removeFile(e){return this.files.delete(e)}getFile(e){const t=this.files.get(e);if(t)return t;throw new Error(`File with id ${e} not found in dnd operation`)}};s.id=0,s=n=o([(0,r.injectable)()],s),t.DnDFileContentStore=s},21257:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.PluginTreeViewNodeLabelProvider=void 0;const r=i(70801),s=i(30970),a=i(17264),c=i(50734),l=i(363),d=i(56090);let u=class{canHandle(e){return l.TreeNode.is(e)&&("resourceUri"in e||"themeIcon"in e)?Number.MAX_SAFE_INTEGER-512:0}getIcon(e){if(e.icon)return e.icon;if(e.themeIcon){if("file"===e.themeIcon.id||"folder"===e.themeIcon.id){const t=e.resourceUri&&new s.default(e.resourceUri)||void 0;if(t)return this.labelProvider.getIcon(a.URIIconReference.create(e.themeIcon.id,t))}return d.ThemeIcon.asClassName(e.themeIcon)}return e.resourceUri?this.labelProvider.getIcon(new s.default(e.resourceUri)):void 0}getName(e){return e.name?e.name:e.resourceUri?this.labelProvider.getName(new s.default(e.resourceUri)):void 0}getLongName(e){return"string"==typeof e.description?e.description:!0===e.description&&e.resourceUri?this.labelProvider.getLongName(new s.default(e.resourceUri)):void 0}};n([(0,r.inject)(a.LabelProvider),o("design:type",a.LabelProvider)],u.prototype,"labelProvider",void 0),n([(0,r.inject)(c.TreeLabelProvider),o("design:type",c.TreeLabelProvider)],u.prototype,"treeLabelProvider",void 0),u=n([(0,r.injectable)()],u),t.PluginTreeViewNodeLabelProvider=u},79467:function(e,t,i){"use strict";var n,o=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.PluginViewRegistry=t.PLUGIN_VIEW_DATA_FACTORY_ID=t.PLUGIN_VIEW_CONTAINER_FACTORY_ID=t.PLUGIN_VIEW_FACTORY_ID=void 0;const s=i(70801),a=i(87361),c=i(14820),l=i(34291),d=i(52879),u=i(78054),h=i(51334),p=i(22448),g=i(10483),f=i(27402),m=i(51138),b=i(12202),v=i(49381),A=i(18894),y=i(949),C=i(62352),w=i(83440),_=i(13825),S=i(60508),E=i(94933),k=i(56090),x=i(4196),D=i(67841),T=i(79877),M=i(9825);t.PLUGIN_VIEW_FACTORY_ID="plugin-view",t.PLUGIN_VIEW_CONTAINER_FACTORY_ID="plugin-view-container",t.PLUGIN_VIEW_DATA_FACTORY_ID="plugin-view-data";let B=n=class{constructor(){this.onDidExpandViewEmitter=new A.Emitter,this.onDidExpandView=this.onDidExpandViewEmitter.event,this.views=new Map,this.viewsWelcome=new Map,this.viewContainers=new Map,this.containerViews=new Map,this.viewClauseContexts=new Map,this.viewDataProviders=new Map,this.viewDataState=new Map,this.webviewViewResolvers=new Map}init(){this.updateFocusedView(),this.shell.onDidChangeActiveWidget((()=>this.updateFocusedView())),this.widgetManager.onWillCreateWidget((({factoryId:e,widget:i,waitUntil:n})=>{if(e===p.EXPLORER_VIEW_CONTAINER_ID&&i instanceof a.ViewContainer&&n(this.prepareViewContainer("explorer",i)),e===h.SCM_VIEW_CONTAINER_ID&&i instanceof a.ViewContainer&&n(this.prepareViewContainer("scm",i)),e===E.SEARCH_VIEW_CONTAINER_ID&&i instanceof a.ViewContainer&&n(this.prepareViewContainer("search",i)),e===d.DebugWidget.ID&&i instanceof d.DebugWidget){const e=i.sessionWidget.viewContainer;n(this.prepareViewContainer("debug",e))}e===t.PLUGIN_VIEW_CONTAINER_FACTORY_ID&&i instanceof a.ViewContainer&&n(this.prepareViewContainer(this.toViewContainerId(i.options),i)),e===t.PLUGIN_VIEW_FACTORY_ID&&i instanceof u.PluginViewWidget&&n(this.prepareView(i))})),this.widgetManager.onDidCreateWidget((e=>{if(e.widget instanceof p.FileNavigatorWidget){const t=new m.DisposableCollection;t.push(this.registerViewWelcome({view:"explorer",content:M.nls.localizeByDefault("You have not yet opened a folder.\n{0}",`[${M.nls.localizeByDefault("Open Folder")}](command:workbench.action.files.openFolder)`),order:0})),t.push(e.widget.onDidDispose((()=>t.dispose())))}})),this.doRegisterViewContainer("test","left",{label:M.nls.localizeByDefault("Test"),iconClass:(0,a.codicon)("beaker"),closeable:!0}),this.contextKeyService.onDidChange((e=>{for(const[,t]of this.views.values()){const i=this.viewClauseContexts.get(t.id);i&&e.affects(i)&&this.updateViewVisibility(t.id)}for(const[t,i]of this.viewsWelcome)for(const[n]of i.entries()){const i=this.toViewWelcomeId(n,t),o=this.viewClauseContexts.get(i);o&&e.affects(o)&&this.updateViewWelcomeVisibility(t)}}));const e=(e,i)=>{let o=new m.DisposableCollection;e.onDidChangeCurrent((e=>{if(o.dispose(),o=new m.DisposableCollection,e&&e.owner instanceof a.BaseWidget){const r=e.owner;let s=n.ID_MAPPINGS.get(r.id);s||r.id.startsWith(t.PLUGIN_VIEW_CONTAINER_FACTORY_ID)&&(s=this.toViewContainerId({id:r.id}));const a=()=>{r.isVisible&&s?i.set(s):i.reset()};o.push(r.onDidChangeVisibility((()=>{a()}))),a()}}))};e(this.shell.leftPanelHandler.dockPanel,this.viewContextKeys.activeViewlet),e(this.shell.rightPanelHandler.dockPanel,this.viewContextKeys.activeAuxiliary),e(this.shell.bottomPanel,this.viewContextKeys.activePanel)}async updateViewWelcomeVisibility(e){const t=await this.getTreeViewWelcomeWidget(e);t&&t.handleWelcomeContextChange()}async updateViewVisibility(e){const t=await this.getView(e);if(!t)return void(this.isViewVisible(e)&&await this.openView(e));const i=this.views.get(e);if(!i)return;const[n]=i,o=await this.getPluginViewContainer(n);if(!o)return;const r=o.getPartFor(t);r&&t.updateViewVisibility((()=>r.setHidden(!this.isViewVisible(e))))}isViewVisible(e){const t=this.views.get(e);if(!t)return!1;const[,i]=t;return void 0===i.when||"true"===i.when||this.contextKeyService.match(i.when)}registerViewContainer(e,t){var i;if(this.viewContainers.has(t.id))return console.warn("view container such id already registered: ",JSON.stringify(t)),m.Disposable.NULL;const n=new m.DisposableCollection,o="theia-plugin-view-container";let r="";const s="plugin-view-container-icon-"+t.id;if(t.themeIcon){const e=k.ThemeIcon.fromString(t.themeIcon);e&&(r=null!==(i=k.ThemeIcon.asClassName(e))&&void 0!==i?i:"")}if(!r){const e=l.PluginSharedStyle.toExternalIconUrl(t.iconUrl);n.push(this.style.insertRule("."+o+"."+s,(()=>`\n                mask: url('${e}') no-repeat 50% 50%;\n                -webkit-mask: url('${e}') no-repeat 50% 50%;\n            `)))}return n.push(this.doRegisterViewContainer(t.id,e,{label:t.title,iconClass:(r||o)+" "+s,closeable:!0})),n}async toggleViewContainer(e){let t=await this.getPluginViewContainer(e);t&&t.isAttached?t.dispose():(t=await this.openViewContainer(e),t&&this.shell.activateWidget(t.id))}doRegisterViewContainer(e,t,i){var n;const o=new m.DisposableCollection;this.viewContainers.set(e,[t,i]),o.push(m.Disposable.create((()=>this.viewContainers.delete(e))));const r=`plugin.view-container.${e}.toggle`;return o.push(this.commands.registerCommand({id:r,label:"Toggle "+i.label+" View"},{execute:()=>this.toggleViewContainer(e)})),o.push(this.menus.registerMenuAction(a.CommonMenus.VIEW_VIEWS,{commandId:r,label:i.label})),o.push(null===(n=this.quickView)||void 0===n?void 0:n.registerItem({label:i.label,open:async()=>{const t=await this.openViewContainer(e);t&&this.shell.activateWidget(t.id)}})),o.push(m.Disposable.create((async()=>{const t=await this.getPluginViewContainer(e);t&&t.dispose()}))),o}getContainerViews(e){return this.containerViews.get(e)||[]}registerView(e,t){var i,n;if(this.views.has(t.id))return console.warn("view with such id already registered: ",JSON.stringify(t)),m.Disposable.NULL;const o=new m.DisposableCollection;t.when=null===(i=t.when)||void 0===i?void 0:i.trim(),this.views.set(t.id,[e,t]),o.push(m.Disposable.create((()=>this.views.delete(t.id))));const r=this.getContainerViews(e);if(r.push(t.id),this.containerViews.set(e,r),o.push(m.Disposable.create((()=>{const e=r.indexOf(t.id);-1!==e&&r.splice(e,1)}))),t.when&&"false"!==t.when&&"true"!==t.when){const e=this.contextKeyService.parseKeys(t.when);e&&(this.viewClauseContexts.set(t.id,e),o.push(m.Disposable.create((()=>this.viewClauseContexts.delete(t.id)))))}return o.push(null===(n=this.quickView)||void 0===n?void 0:n.registerItem({label:t.name,when:t.when,open:()=>this.openView(t.id,{activate:!0})})),o.push(this.commands.registerCommand({id:`${t.id}.focus`},{execute:async()=>{await this.openView(t.id,{activate:!0})}})),o}async registerWebviewView(e,t){if(this.webviewViewResolvers.has(e))throw new Error(`View resolver already registered for ${e}`);this.webviewViewResolvers.set(e,t);const i=await this.createNewWebviewView(),n=D.CancellationToken.None;return this.getView(e).then((async t=>{if(t)if(t.isVisible)await this.prepareView(t,i.webview.identifier.id);else{const n=new m.DisposableCollection(this.onDidExpandView((async n=>{n===e&&(o(),await this.prepareView(t,i.webview.identifier.id))}))),o=()=>n.dispose();t.disposed.connect(o),n.push(m.Disposable.create((()=>t.disposed.disconnect(o))))}})),t.resolve(i,n),m.Disposable.create((()=>{this.webviewViewResolvers.delete(e)}))}async createNewWebviewView(){const e=await this.widgetManager.getOrCreateWidget(x.WebviewWidget.FACTORY_ID,{id:(0,T.v4)()});let t;return e.setContentOptions({allowScripts:!0}),{webview:e,get onDidChangeVisibility(){return e.onDidChangeVisibility},get onDidDispose(){return e.onDidDispose},get title(){return e.title.label},set title(t){e.title.label=t||""},get description(){return t},set description(e){t=e},get badge(){return e.badge},set badge(t){e.badge=t},get badgeTooltip(){return e.badgeTooltip},set badgeTooltip(t){e.badgeTooltip=t},onDidChangeBadge:e.onDidChangeBadge,onDidChangeBadgeTooltip:e.onDidChangeBadgeTooltip,dispose:e.dispose,show:e.show}}registerViewWelcome(e){const t=new m.DisposableCollection,i=this.viewsWelcome.get(e.view)||[];if(i.some((t=>t.content===e.content)))return t;if(i.push(e),this.viewsWelcome.set(e.view,i),this.handleViewWelcomeChange(e.view),t.push(m.Disposable.create((()=>{const t=i.indexOf(e);-1!==t&&i.splice(t,1),this.handleViewWelcomeChange(e.view)}))),e.when){const n=i.indexOf(e),o=this.toViewWelcomeId(n,e.view);this.viewClauseContexts.set(o,this.contextKeyService.parseKeys(e.when)),t.push(m.Disposable.create((()=>this.viewClauseContexts.delete(o))))}return t}async handleViewWelcomeChange(e){const t=await this.getTreeViewWelcomeWidget(e);t&&t.handleViewWelcomeContentChange(this.getViewWelcomes(e))}async getTreeViewWelcomeWidget(e){return"explorer"===e?this.widgetManager.getWidget(p.FILE_NAVIGATOR_ID):this.widgetManager.getWidget(t.PLUGIN_VIEW_DATA_FACTORY_ID,{id:e})}getViewWelcomes(e){return this.viewsWelcome.get(e)||[]}async getView(e){if(this.views.has(e))return this.widgetManager.getWidget(t.PLUGIN_VIEW_FACTORY_ID,this.toPluginViewWidgetIdentifier(e))}async openView(e,t){const i=await this.doOpenView(e);return i&&t&&(!0===t.activate?await this.shell.activateWidget(i.id):!0===t.reveal&&await this.shell.revealWidget(i.id)),i}async doOpenView(e){const t=await this.getView(e);if(t)return t;const i=this.views.get(e);if(!i)return;const[n]=i;return await this.openViewContainer(n),this.getView(e)}async prepareView(e,t){const i=this.views.get(e.options.viewId);if(!i)return;const[,n]=i;e.title.label||(e.title.label=n.name);const o=e.widgets[0],r=await this.createViewDataWidget(n.id,t);e.isDisposed?null==r||r.dispose():o!==r&&(o&&o.dispose(),r&&e.addWidget(r))}getOrCreateViewContainerWidget(e){const i=this.toViewContainerIdentifier(e);return this.widgetManager.getOrCreateWidget(t.PLUGIN_VIEW_CONTAINER_FACTORY_ID,i)}async openViewContainer(e){if("explorer"===e){const e=await this.explorer.openView();return e.parent instanceof a.ViewContainer?e.parent:void 0}if("scm"===e){const e=await this.scm.openView();return e.parent instanceof a.ViewContainer?e.parent:void 0}if("debug"===e)return(await this.debug.openView()).sessionWidget.viewContainer;const t=this.viewContainers.get(e);if(!t)return;const[i]=t,n=await this.getOrCreateViewContainerWidget(e);return n.isAttached||await this.shell.addWidget(n,{area:a.ApplicationShell.isSideArea(i)?i:"left",rank:Number.MAX_SAFE_INTEGER}),n}async prepareViewContainer(e,i){const n=this.viewContainers.get(e);if(n){const[,e]=n;i.setTitleOptions(e)}for(const n of this.getContainerViews(e)){const e=this.toPluginViewWidgetIdentifier(n),o=this.widgetManager.tryGetWidget(t.PLUGIN_VIEW_FACTORY_ID,e);if(o&&o.currentViewContainerId){const e=await this.getPluginViewContainer(o.currentViewContainerId);if(e&&this.registerWidgetPartEvents(o,e))continue}const r=await this.widgetManager.getOrCreateWidget(t.PLUGIN_VIEW_FACTORY_ID,e);-1===i.getTrackableWidgets().indexOf(r)&&i.addWidget(r,{initiallyCollapsed:!!i.getParts().length,initiallyHidden:!this.isViewVisible(n)}),this.registerWidgetPartEvents(r,i)}}registerWidgetPartEvents(e,t){const i=t.getPartFor(e);if(i){e.currentViewContainerId=this.getViewContainerId(t),i.onDidMove((t=>{e.currentViewContainerId=this.getViewContainerId(t)})),i.onDidChangeVisibility((()=>e.suppressUpdateViewVisibility=i.isHidden));const n=()=>{if(0===e.widgets.length){if(!i.collapsed&&i.isVisible){const t=this.toViewId(e.options);this.onDidExpandViewEmitter.fire(t)}}else o.dispose()},o=new m.DisposableCollection(i.onCollapsed(n),i.onDidChangeVisibility(n));return n(),i}}getViewContainerId(e){var i;const n=this.widgetManager.getDescription(e);switch(null==n?void 0:n.factoryId){case p.EXPLORER_VIEW_CONTAINER_ID:return"explorer";case h.SCM_VIEW_CONTAINER_ID:return"scm";case E.SEARCH_VIEW_CONTAINER_ID:return"search";case void 0:return(null===(i=e.parent)||void 0===i?void 0:i.parent)instanceof d.DebugWidget?"debug":e.id;case t.PLUGIN_VIEW_CONTAINER_FACTORY_ID:return this.toViewContainerId(n.options);default:return e.id}}async getPluginViewContainer(e){if("explorer"===e)return this.widgetManager.getWidget(p.EXPLORER_VIEW_CONTAINER_ID);if("scm"===e)return this.widgetManager.getWidget(h.SCM_VIEW_CONTAINER_ID);if("search"===e)return this.widgetManager.getWidget(E.SEARCH_VIEW_CONTAINER_ID);if("debug"===e){const e=await this.widgetManager.getWidget(d.DebugWidget.ID);if(e instanceof d.DebugWidget)return e.sessionWidget.viewContainer}const i=this.toViewContainerIdentifier(e);return this.widgetManager.getWidget(t.PLUGIN_VIEW_CONTAINER_FACTORY_ID,i)}async initViewContainer(e){let t=await this.getPluginViewContainer(e);t?await this.prepareViewContainer(this.toViewContainerId(t.options),t):(t=await this.openViewContainer(e),t&&!t.getParts().filter((e=>!e.isHidden)).length&&t.dispose())}async initWidgets(){const e=[];for(const t of this.viewContainers.keys())e.push((async()=>{await this.initViewContainer(t)})().catch(console.error));e.push((async()=>{const e=await this.widgetManager.getWidget(p.EXPLORER_VIEW_CONTAINER_ID);e instanceof a.ViewContainer&&await this.prepareViewContainer("explorer",e)})().catch(console.error)),e.push((async()=>{const e=await this.widgetManager.getWidget(h.SCM_VIEW_CONTAINER_ID);e instanceof a.ViewContainer&&await this.prepareViewContainer("scm",e)})().catch(console.error)),e.push((async()=>{const e=await this.widgetManager.getWidget(E.SEARCH_VIEW_CONTAINER_ID);e instanceof a.ViewContainer&&await this.prepareViewContainer("search",e)})().catch(console.error)),e.push((async()=>{const e=await this.widgetManager.getWidget(d.DebugWidget.ID);if(e instanceof d.DebugWidget){const t=e.sessionWidget.viewContainer;await this.prepareViewContainer("debug",t)}})().catch(console.error)),await Promise.all(e)}async removeStaleWidgets(){const e=this.widgetManager.getWidgets(t.PLUGIN_VIEW_FACTORY_ID);for(const t of e)if(t instanceof u.PluginViewWidget){const e=this.toViewId(t.options);this.views.has(e)||t.dispose()}const i=this.widgetManager.getWidgets(t.PLUGIN_VIEW_CONTAINER_FACTORY_ID);for(const e of i)if(e instanceof a.ViewContainer){const t=this.toViewContainerId(e.options);this.viewContainers.has(t)||e.dispose()}}toViewContainerIdentifier(e){return{id:t.PLUGIN_VIEW_CONTAINER_FACTORY_ID+":"+e,progressLocationId:e}}toViewContainerId(e){return e.id.substring(t.PLUGIN_VIEW_CONTAINER_FACTORY_ID.length+1)}toPluginViewWidgetIdentifier(e){return{id:t.PLUGIN_VIEW_FACTORY_ID+":"+e,viewId:e}}toViewId(e){return e.viewId}toViewWelcomeId(e,t){return`view-welcome.${t}.${e}`}onDidInitializeLayout(){const e=this.widgetManager.getWidgets(t.PLUGIN_VIEW_DATA_FACTORY_ID);for(const t of e){if(a.StatefulWidget.is(t)){const e=t.storeState();e&&this.viewDataState.set(t.id,e)}t.dispose()}}registerViewDataProvider(e,t){if(this.viewDataProviders.has(e))return console.error(`data provider for '${e}' view is already registered`),m.Disposable.NULL;this.viewDataProviders.set(e,t);const i=new m.DisposableCollection(m.Disposable.create((()=>{this.viewDataProviders.delete(e),this.viewDataState.delete(e)})));return this.getView(e).then((async t=>{if(!i.disposed&&t)if(t.isVisible)await this.prepareView(t);else{const n=new m.DisposableCollection(this.onDidExpandView((async i=>{i===e&&(o(),await this.prepareView(t))}))),o=()=>n.dispose();t.disposed.connect(o),n.push(m.Disposable.create((()=>t.disposed.disconnect(o)))),i.push(n)}})),i}async createViewDataWidget(e,t){var i;const n=this.views.get(e);if((null===(i=null==n?void 0:n[1])||void 0===i?void 0:i.type)===c.PluginViewType.Webview)return this.widgetManager.getWidget(x.WebviewWidget.FACTORY_ID,{id:t});const o=this.viewDataProviders.get(e);if(!n||!o)return;const[,r]=n,s=this.viewDataState.get(e),l=await o({state:s,viewInfo:r});return l.handleViewWelcomeContentChange(this.getViewWelcomes(e)),a.StatefulWidget.is(l)?this.storeViewDataStateOnDispose(e,l):this.viewDataState.delete(e),l}storeViewDataStateOnDispose(e,t){const i=t.dispose.bind(t);t.dispose=()=>{const n=t.storeState();n&&this.viewDataState.set(e,n),i()}}isVisibleWidget(e){return!e.isDisposed&&e.isVisible}updateFocusedView(){const e=this.shell.activeWidget;e instanceof u.PluginViewWidget?this.viewContextKeys.focusedView.set(e.options.viewId):this.viewContextKeys.focusedView.reset()}};B.ID_MAPPINGS=new Map([[p.EXPLORER_VIEW_CONTAINER_ID,"workbench.view.explorer"],[h.SCM_VIEW_CONTAINER_ID,"workbench.view.scm"],[E.SEARCH_VIEW_CONTAINER_ID,"workbench.view.search"],[d.DebugWidget.ID,"workbench.view.debug"],["vsx-extensions-view-container","workbench.view.extensions"],[w.PROBLEMS_WIDGET_ID,"workbench.panel.markers"],[_.OutputWidget.ID,"workbench.panel.output"],[S.DebugConsoleContribution.options.id,"workbench.panel.repl"]]),o([(0,s.inject)(a.ApplicationShell),r("design:type",a.ApplicationShell)],B.prototype,"shell",void 0),o([(0,s.inject)(l.PluginSharedStyle),r("design:type",l.PluginSharedStyle)],B.prototype,"style",void 0),o([(0,s.inject)(a.WidgetManager),r("design:type",a.WidgetManager)],B.prototype,"widgetManager",void 0),o([(0,s.inject)(h.ScmContribution),r("design:type",h.ScmContribution)],B.prototype,"scm",void 0),o([(0,s.inject)(g.FileNavigatorContribution),r("design:type",g.FileNavigatorContribution)],B.prototype,"explorer",void 0),o([(0,s.inject)(f.DebugFrontendApplicationContribution),r("design:type",f.DebugFrontendApplicationContribution)],B.prototype,"debug",void 0),o([(0,s.inject)(b.CommandRegistry),r("design:type",b.CommandRegistry)],B.prototype,"commands",void 0),o([(0,s.inject)(v.MenuModelRegistry),r("design:type",v.MenuModelRegistry)],B.prototype,"menus",void 0),o([(0,s.inject)(a.QuickViewService),(0,s.optional)(),r("design:type",a.QuickViewService)],B.prototype,"quickView",void 0),o([(0,s.inject)(y.ContextKeyService),r("design:type",Object)],B.prototype,"contextKeyService",void 0),o([(0,s.inject)(C.ViewContextKeyService),r("design:type",C.ViewContextKeyService)],B.prototype,"viewContextKeys",void 0),o([(0,s.postConstruct)(),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],B.prototype,"init",null),B=n=o([(0,s.injectable)()],B),t.PluginViewRegistry=B},78054:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.PluginViewWidget=t.PluginViewWidgetIdentifier=void 0;const r=i(70801),s=i(29486),a=i(49381),c=i(12202),l=i(46395),d=i(65156),u=i(9825),h=i(949);let p=class{};p=n([(0,r.injectable)()],p),t.PluginViewWidgetIdentifier=p;let g=class extends s.Panel{constructor(){super(),this._description="",this._suppressUpdateViewVisibility=!1,this.updatingViewVisibility=!1,this.onDidChangeDescriptionEmitter=new u.Emitter,this.onDidChangeBadgeEmitter=new u.Emitter,this.onDidChangeBadgeTooltipEmitter=new u.Emitter,this.toDispose=new u.DisposableCollection(this.onDidChangeDescriptionEmitter,this.onDidChangeBadgeEmitter,this.onDidChangeBadgeTooltipEmitter),this.onDidChangeToolbarItemsEmitter=new u.Emitter,this.node.tabIndex=-1,this.node.style.height="100%"}get onDidChangeToolbarItems(){return this.onDidChangeToolbarItemsEmitter.event}init(){this.id=this.options.id;const e=this.contextKeyService.createScoped(this.node);e.setContext("view",this.options.viewId),this.toDispose.push(e)}get onDidChangeDescription(){return this.onDidChangeDescriptionEmitter.event}get onDidChangeBadge(){return this.onDidChangeBadgeEmitter.event}get onDidChangeBadgeTooltip(){return this.onDidChangeBadgeTooltipEmitter.event}onActivateRequest(e){super.onActivateRequest(e);const t=this.widgets[0];t?(t.activate(),this.updateWidgetMessage()):this.node.focus()}storeState(){return{label:this.title.label,message:this.message,widgets:this.widgets,suppressUpdateViewVisibility:this._suppressUpdateViewVisibility,currentViewContainerId:this.currentViewContainerId}}restoreState(e){this.title.label=e.label,this.message=e.message,this.suppressUpdateViewVisibility=e.suppressUpdateViewVisibility,this.currentViewContainerId=e.currentViewContainerId;for(const t of e.widgets)this.addWidget(t)}set suppressUpdateViewVisibility(e){this._suppressUpdateViewVisibility=!this.updatingViewVisibility&&e}updateViewVisibility(e){if(!this._suppressUpdateViewVisibility)try{this.updatingViewVisibility=!0,e()}finally{this.updatingViewVisibility=!1}}get message(){return this._message}set message(e){this._message=e,this.updateWidgetMessage()}get description(){return this._description}set description(e){this._description=e,this.onDidChangeDescriptionEmitter.fire()}get badge(){const e=this.widgets[0];return d.BadgeWidget.is(e)?e.badge:this._badge}set badge(e){this._badge=e,this.onDidChangeBadgeEmitter.fire()}get badgeTooltip(){const e=this.widgets[0];return d.BadgeWidget.is(e)?e.badgeTooltip:this._badgeTooltip}set badgeTooltip(e){this._badgeTooltip=e,this.onDidChangeBadgeTooltipEmitter.fire()}updateWidgetMessage(){const e=this.widgets[0];e&&e instanceof l.TreeViewWidget&&(e.message=this._message)}addWidget(e){super.addWidget(e),d.BadgeWidget.is(e)&&(e.onDidChangeBadge((()=>this.onDidChangeBadgeEmitter.fire())),e.onDidChangeBadgeTooltip((()=>this.onDidChangeBadgeTooltipEmitter.fire()))),this.updateWidgetMessage(),this.onDidChangeToolbarItemsEmitter.fire()}insertWidget(e,t){super.insertWidget(e,t),this.updateWidgetMessage(),this.onDidChangeToolbarItemsEmitter.fire()}dispose(){this.toDispose.dispose(),super.dispose()}};n([(0,r.inject)(a.MenuModelRegistry),o("design:type",a.MenuModelRegistry)],g.prototype,"menus",void 0),n([(0,r.inject)(c.CommandRegistry),o("design:type",c.CommandRegistry)],g.prototype,"commands",void 0),n([(0,r.inject)(h.ContextKeyService),o("design:type",Object)],g.prototype,"contextKeyService",void 0),n([(0,r.inject)(p),o("design:type",p)],g.prototype,"options",void 0),n([(0,r.postConstruct)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],g.prototype,"init",null),g=n([(0,r.injectable)(),o("design:paramtypes",[])],g),t.PluginViewWidget=g},38744:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.bindTreeViewDecoratorUtilities=t.TreeViewDecoratorService=t.TreeViewDecoratorAdapter=t.TreeViewDecorator=void 0;const s=i(70801),a=i(79530),c=i(9825),l=i(30970),d=i(21549);t.TreeViewDecorator=Symbol("TreeViewDecorator");let u=class extends d.FileTreeDecoratorAdapter{getUriForNode(e){if(this.isTreeItem(e))return new l.default(e.resourceUri).toString()}isTreeItem(e){return(0,c.isObject)(e)&&!!e.resourceUri}};u=n([(0,s.injectable)()],u),t.TreeViewDecoratorAdapter=u;let h=class extends a.AbstractTreeDecoratorService{constructor(e){super(e.getContributions())}};h=n([(0,s.injectable)(),r(0,(0,s.inject)(c.ContributionProvider)),r(0,(0,s.named)(t.TreeViewDecorator)),o("design:paramtypes",[Object])],h),t.TreeViewDecoratorService=h,t.bindTreeViewDecoratorUtilities=function(e){e(u).toSelf().inSingletonScope(),(0,c.bindContributionProvider)(e,t.TreeViewDecorator),e(t.TreeViewDecorator).toService(u)}},46395:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.TreeViewWidget=t.PluginTreeModel=t.PluginTree=t.TreeViewWidgetOptions=t.CompositeTreeViewNode=t.ResolvableCompositeTreeViewNode=t.ResolvableTreeViewNode=t.TreeViewNode=t.VIEW_ITEM_INLINE_MENU=t.VIEW_ITEM_CONTEXT_MENU=t.TREE_NODE_HYPERLINK=void 0;const r=i(70801),s=i(16138),a=i(87361),c=i(49381),l=i(92664),d=i(34291),u=i(35022),h=i(18894),p=i(13318),g=i(30970),f=i(949),m=i(93838),b=i(18134),v=i(53414),A=i(79530),y=i(9825),C=i(67037),w=i(60516),_=i(20607);var S,E;t.TREE_NODE_HYPERLINK="theia-TreeNodeHyperlink",t.VIEW_ITEM_CONTEXT_MENU=["view-item-context-menu"],t.VIEW_ITEM_INLINE_MENU=["view-item-context-menu","inline"],function(e){e.is=function(e){return!!e&&a.SelectableTreeNode.is(e)&&A.DecoratedTreeNode.is(e)}}(S=t.TreeViewNode||(t.TreeViewNode={}));class k{constructor(e,t){this._resolved=!1,(0,C.mixin)(this,e),this.resolve=async e=>{var i,n;if(this.resolving)return this.resolving.promise;if(!this._resolved){this.resolving=new w.Deferred;const o=await t(e);o&&(this.command=null!==(i=this.command)&&void 0!==i?i:o.command,this.tooltip=null!==(n=this.tooltip)&&void 0!==n?n:o.tooltip),this.resolving.resolve(),this.resolving=void 0}e.isCancellationRequested||(this._resolved=!0)}}reset(){this._resolved=!1,this.resolving=void 0,this.command=void 0,this.tooltip=void 0}get resolved(){return this._resolved}}t.ResolvableTreeViewNode=k;class x extends k{constructor(e,t){super(e,t),this.expanded=e.expanded,this.children=e.children}}t.ResolvableCompositeTreeViewNode=x,function(e){e.is=function(e){return S.is(e)&&a.ExpandableTreeNode.is(e)&&a.CompositeTreeNode.is(e)}}(E=t.CompositeTreeViewNode||(t.CompositeTreeViewNode={}));let D=class{};D=n([(0,r.injectable)()],D),t.TreeViewWidgetOptions=D;let T=class extends a.TreeImpl{constructor(){super(...arguments),this.onDidChangeWelcomeStateEmitter=new h.Emitter,this.onDidChangeWelcomeState=this.onDidChangeWelcomeStateEmitter.event,this._hasTreeItemResolve=Promise.resolve(!1)}set proxy(e){this._proxy=e,this._hasTreeItemResolve=e?e.$hasResolveTreeItem(this.options.id):Promise.resolve(!1)}get proxy(){return this._proxy}get hasTreeItemResolve(){return this._hasTreeItemResolve}set viewInfo(e){this._viewInfo=e}get isEmpty(){return this._isEmpty}async resolveChildren(e){if(!this._proxy)return super.resolveChildren(e);const t=await this.fetchChildren(this._proxy,e),i=await this.hasTreeItemResolve;return t.map((t=>i?this.createResolvableTreeNode(t,e):this.createTreeNode(t,e)))}async fetchChildren(e,t){try{const i=await e.$getChildren(this.options.id,t.id),n=this._isEmpty;return this._isEmpty=!(t.id||i&&0!==i.length),n!==this._isEmpty&&this.onDidChangeWelcomeStateEmitter.fire(),i||[]}catch(e){if(e){console.error(`Failed to fetch children for '${this.options.id}'`,e);const t=this._viewInfo?this._viewInfo.name:this.options.id;this.notification.error(`${t}: ${e.message}`)}return[]}}createTreeNode(e,t){const i=this.createTreeNodeUpdate(e),n=this.getNode(e.id);return void 0!==e.collapsibleState&&e.collapsibleState!==s.TreeViewItemCollapsibleState.None?E.is(n)?Object.assign(n,i):Object.assign({id:e.id,parent:t,visible:!0,selected:!1,expanded:s.TreeViewItemCollapsibleState.Expanded===e.collapsibleState,children:[],command:e.command},i):S.is(n)&&!a.ExpandableTreeNode.is(n)?Object.assign(n,i,{command:e.command}):Object.assign({id:e.id,parent:t,visible:!0,selected:!1,command:e.command},i)}createResolvableTreeNode(e,t){const i=this.createTreeNodeUpdate(e),n=this.getNode(e.id);if(void 0!==e.collapsibleState&&e.collapsibleState!==s.TreeViewItemCollapsibleState.None){if(n instanceof x)return n.reset(),Object.assign(n,i);const o=Object.assign({id:e.id,parent:t,visible:!0,selected:!1,expanded:s.TreeViewItemCollapsibleState.Expanded===e.collapsibleState,children:[],command:e.command},i);return new x(o,(async t=>{var i;return null===(i=this._proxy)||void 0===i?void 0:i.$resolveTreeItem(this.options.id,e.id,t)}))}if(n instanceof k&&!a.ExpandableTreeNode.is(n))return n.reset(),Object.assign(n,i);const o=Object.assign({id:e.id,parent:t,visible:!0,selected:!1,command:e.command},i);return new k(o,(async t=>{var i;return null===(i=this._proxy)||void 0===i?void 0:i.$resolveTreeItem(this.options.id,e.id,t)}))}createTreeNodeUpdate(e){const t=this.toDecorationData(e),i=this.toIconClass(e),n=e.resourceUri&&g.URI.fromComponents(e.resourceUri).toString(),o=e.themeIcon?e.themeIcon:e.collapsibleState!==s.TreeViewItemCollapsibleState.None?{id:"folder"}:void 0;return{name:e.label,decorationData:t,icon:i,description:e.description,themeIcon:o,resourceUri:n,tooltip:e.tooltip,contextValue:e.contextValue,command:e.command,accessibilityInformation:e.accessibilityInformation}}toDecorationData(e){let t={};return e.highlights&&(t={highlight:{ranges:e.highlights.map((e=>({offset:e[0],length:e[1]-e[0]})))}}),t}toIconClass(e){if(e.icon)return"fa "+e.icon;if(e.iconUrl){const t=this.sharedStyle.toIconClass(e.iconUrl);return this.toDispose.push(t),t.object.iconClass}}};n([(0,r.inject)(d.PluginSharedStyle),o("design:type",d.PluginSharedStyle)],T.prototype,"sharedStyle",void 0),n([(0,r.inject)(D),o("design:type",D)],T.prototype,"options",void 0),n([(0,r.inject)(p.MessageService),o("design:type",p.MessageService)],T.prototype,"notification",void 0),T=n([(0,r.injectable)()],T),t.PluginTree=T;let M=class extends a.TreeModelImpl{set proxy(e){this.tree.proxy=e}get proxy(){return this.tree.proxy}get hasTreeItemResolve(){return this.tree.hasTreeItemResolve}set viewInfo(e){this.tree.viewInfo=e}get isTreeEmpty(){return this.tree.isEmpty}get onDidChangeWelcomeState(){return this.tree.onDidChangeWelcomeState}doOpenNode(e){super.doOpenNode(e),e instanceof k&&e.resolve(y.CancellationToken.None)}};n([(0,r.inject)(T),o("design:type",T)],M.prototype,"tree",void 0),M=n([(0,r.injectable)()],M),t.PluginTreeModel=M;let B=class extends a.TreeViewWelcomeWidget{constructor(){super(...arguments),this._contextSelection=!1,this.expansionTimeouts=new Map}init(){super.init(),this.id=this.options.id,this.addClass("theia-tree-view"),this.node.style.height="100%",this.model.onDidChangeWelcomeState(this.update,this),this.toDispose.push(this.model.onDidChangeWelcomeState(this.update,this)),this.toDispose.push(this.onDidChangeVisibilityEmitter),this.toDispose.push(this.contextKeyService.onDidChange((()=>this.update()))),this.treeDragType=`application/vnd.code.tree.${this.id.toLowerCase()}`}get showCollapseAll(){return this.options.showCollapseAll||!1}renderIcon(e,t){var i;const n=this.toNodeIcon(e);if(n){let t;if(S.is(e)&&(null===(i=e.themeIcon)||void 0===i?void 0:i.color)){const i=this.colorRegistry.getCurrentColor(e.themeIcon.color.id);i&&(t={color:i})}return l.createElement("div",{className:n+" theia-tree-view-icon",style:t})}}renderCaption(e,t){const i=[a.TREE_NODE_SEGMENT_CLASS];this.hasTrailingSuffixes(e)||i.push(a.TREE_NODE_SEGMENT_GROW_CLASS);const n=i.join(" ");let o={...this.decorateCaption(e,{}),className:n,id:e.id};if(e.accessibilityInformation&&(o={...o,"aria-label":e.accessibilityInformation.label,role:e.accessibilityInformation.role}),!e.tooltip&&e instanceof k){let t,i=!1;o={...o,onMouseLeave:()=>null==t?void 0:t.cancel(),onMouseEnter:async n=>{if(i)m.MarkdownString.is(e.tooltip)&&this.hoverService.requestHover({content:e.tooltip,target:n.target,position:"right"});else{if(!e.resolved){t=new y.CancellationTokenSource;const i=t.token;if(await e.resolve(i),i.isCancellationRequested)return}if(m.MarkdownString.is(e.tooltip))this.hoverService.requestHover({content:e.tooltip,target:n.target,position:"right"});else{const t=e.tooltip||e.resourceUri&&this.labelProvider.getLongName(new g.URI(e.resourceUri))||this.toNodeName(e);n.currentTarget.title=t}i=!0}}}}else if(m.MarkdownString.is(e.tooltip))o={...o,onMouseEnter:t=>{this.hoverService.requestHover({content:e.tooltip,target:t.target,position:"right"})}};else{const t=e.tooltip||e.resourceUri&&this.labelProvider.getLongName(new g.URI(e.resourceUri))||this.toNodeName(e);o={...o,title:t}}const r=[],s=this.toNodeName(e),c=this.getDecorationData(e,"highlight")[0];c&&r.push(this.toReactNode(s,c));const d=this.searchHighlights&&this.searchHighlights.get(e.id);d?r.push(...this.toReactNode(s,d)):c||r.push(s);const u=this.toNodeDescription(e);return u&&r.push(l.createElement("span",{className:"theia-tree-view-description"},u)),l.createElement("div",{...o},...r)}createNodeAttributes(e,t){const i=super.createNodeAttributes(e,t);return this.options.dragMimeTypes&&(i.onDragStart=t=>this.handleDragStartEvent(e,t),i.onDragEnd=t=>this.handleDragEnd(e,t),i.draggable=!0),this.options.dropMimeTypes&&(i.onDrop=t=>this.handleDropEvent(e,t),i.onDragEnter=t=>this.handleDragEnter(e,t),i.onDragLeave=t=>this.handleDragLeave(e,t),i.onDragOver=e=>this.handleDragOver(e)),i}handleDragLeave(e,t){const i=this.expansionTimeouts.get(e.id);void 0!==i&&(console.debug(`dragleave ${e.id} canceling timeout`),clearTimeout(i),this.expansionTimeouts.delete(e.id))}handleDragEnter(e,t){console.debug(`dragenter ${e.id}`),a.ExpandableTreeNode.is(e)&&(console.debug(`dragenter ${e.id} starting timeout`),this.expansionTimeouts.set(e.id,window.setTimeout((()=>{console.debug(`dragenter ${e.id} timeout reached`),this.model.expandNode(e)}),500)))}createContainerAttributes(){const e=super.createContainerAttributes();return this.options.dropMimeTypes&&(e.onDrop=e=>this.handleDropEvent(void 0,e),e.onDragOver=e=>this.handleDragOver(e)),e}handleDragStartEvent(e,t){t.dataTransfer.setData(this.treeDragType,"");let i=[];i=this.model.selectedNodes.find((t=>a.TreeNode.equals(t,e)))?this.model.selectedNodes.filter(S.is):[e],this.options.dragMimeTypes.forEach((e=>{"text/uri-list"===e?a.ApplicationShell.setDraggedEditorUris(t.dataTransfer,i.filter((e=>e.resourceUri)).map((e=>new g.URI(e.resourceUri)))):t.dataTransfer.setData(e,"")})),this.model.proxy.$dragStarted(this.options.id,i.map((e=>e.id)),y.CancellationToken.None).then((e=>{e&&this.applicationShell.addAdditionalDraggedEditorUris(e.map(g.URI.fromComponents))}))}handleDragEnd(e,t){this.applicationShell.clearAdditionalDraggedEditorUris(),this.model.proxy.$dragEnd(this.id)}handleDragOver(e){e.dataTransfer&&(e.dataTransfer.types.some((e=>this.options.dropMimeTypes.includes(e)))||e.dataTransfer.types.includes(this.treeDragType)||this.options.dropMimeTypes.includes("files")&&(e=>{for(let t=0;t<e.length;t++)if("file"===e[t].kind)return!0;return!1})(e.dataTransfer.items)?(e.preventDefault(),e.dataTransfer.dropEffect="move"):e.dataTransfer.dropEffect="none",e.stopPropagation())}handleDropEvent(e,t){var i;if(t.dataTransfer){const n=[];let o=[];try{for(let e=0;e<t.dataTransfer.items.length;e++){const i=t.dataTransfer.items[e];if(i.type!==this.treeDragType){const r=t.dataTransfer.items[e].getAsFile();if(r){const e=this.dndFileContentStore.addFile(r);o.push(e);const t=r.path?{scheme:"file",path:r.path,authority:"",query:"",fragment:""}:void 0;n.push([i.type,new s.DataTransferFileDTO(r.name,e,t)])}else{const e=t.dataTransfer.getData(i.type);e&&n.push([i.type,e])}}}(n.length>0||t.dataTransfer.types.includes(this.treeDragType))&&(t.preventDefault(),t.stopPropagation(),null===(i=this.model.proxy)||void 0===i||i.$drop(this.id,null==e?void 0:e.id,n,y.CancellationToken.None).finally((()=>{for(const e of o)this.dndFileContentStore.removeFile(e)})),o=[])}catch(e){for(const e of o)this.dndFileContentStore.removeFile(e);throw e}}}renderTailDecorations(e,i){return this.contextKeys.with({view:this.id,viewItem:e.contextValue},(()=>{const n=this.menus.getMenu(t.VIEW_ITEM_INLINE_MENU),o=this.toContextMenuArgs(e),r=n.children.filter((e=>e instanceof c.ActionMenuNode)),s=super.renderTailDecorations(e,i);return l.createElement(l.Fragment,null,r.length>0&&l.createElement("div",{className:a.TREE_NODE_SEGMENT_CLASS+" flex"},r.map(((t,i)=>this.renderInlineCommand(t,i,this.focusService.hasFocus(e),o)))),void 0!==s&&l.createElement("div",{className:a.TREE_NODE_SEGMENT_CLASS+" flex"},s))}))}toTreeViewItemReference(e){return{viewId:this.id,itemId:e.id}}renderInlineCommand(e,t,i,n){if(!(e.icon&&this.commands.isVisible(e.command,...n)&&e.when&&this.contextKeys.match(e.when)))return!1;const o=[a.TREE_NODE_SEGMENT_CLASS,a.TREE_NODE_TAIL_CLASS,e.icon,u.ACTION_ITEM,"theia-tree-view-inline-action"].join(" "),r=i?0:void 0;return l.createElement("div",{key:t,className:o,title:e.label,tabIndex:r,onClick:t=>{t.stopPropagation(),this.commands.executeCommand(e.command,...n)}})}toContextMenuArgs(e){return this.options.multiSelect?[this.toTreeViewItemReference(e),this.model.selectedNodes.map((e=>this.toTreeViewItemReference(e)))]:[this.toTreeViewItemReference(e)]}setFlag(e){super.setFlag(e),e===u.Widget.Flag.IsVisible&&this.onDidChangeVisibilityEmitter.fire(this.isVisible)}clearFlag(e){super.clearFlag(e),e===u.Widget.Flag.IsVisible&&this.onDidChangeVisibilityEmitter.fire(this.isVisible)}handleEnter(e){super.handleEnter(e),this.tryExecuteCommand()}tapNode(e){super.tapNode(e),this.findCommands(e).then((t=>{t.size>0?this.tryExecuteCommandMap(t):e&&this.isExpandable(e)&&this.model.toggleNodeExpansion(e)}))}async tryExecuteCommand(e){this.tryExecuteCommandMap(await this.findCommands(e))}tryExecuteCommandMap(e){e.forEach(((e,t)=>{this.commands.executeCommand(t,...e)}))}async findCommands(e){const t=new Map,i=e?[e]:this.model.selectedNodes;if(await this.model.hasTreeItemResolve){const e=(new y.CancellationTokenSource).token,t=Promise.all(i.map((t=>!t.command&&t instanceof k&&!t.resolved?t.resolve(e).catch((e=>{console.error(`Failed to resolve tree item '${t.id}'`,e)})):Promise.resolve(t))));await t}for(const e of i)e&&e.command&&t.set(e.command.id,e.command.arguments||[]);return t}get message(){return this._message}set message(e){this._message=e,this.update()}render(){return l.createElement("div",this.createContainerAttributes(),this.renderSearchInfo(),this.renderTree(this.model))}renderSearchInfo(){if(this._message)return l.createElement("div",{className:"theia-TreeViewInfo"},this._message)}shouldShowWelcomeView(){return(void 0===this.model.proxy||this.model.isTreeEmpty)&&void 0===this.message}handleContextMenuEvent(e,t){if(a.SelectableTreeNode.is(e)){if(!this.props.multiSelect||!e.selected){const i=this.props.multiSelect&&this.hasCtrlCmdMask(t)?a.TreeSelection.SelectionType.TOGGLE:a.TreeSelection.SelectionType.DEFAULT;this.model.addSelection({node:e,type:i})}this.focusService.setFocus(e);const i=this.props.contextMenuPath;if(i){const{x:n,y:o}=t.nativeEvent,r=this.toContextMenuArgs(e),s=this.contextKeyService.createOverlay([["viewItem",S.is(e)&&e.contextValue||void 0],["view",this.options.id]]);setTimeout((()=>this.contextMenuRenderer.render({menuPath:i,anchor:{x:n,y:o},args:r,contextKeyService:s,onHide:()=>s.dispose()})),10)}}t.stopPropagation(),t.preventDefault()}};n([(0,r.inject)(a.ApplicationShell),o("design:type",a.ApplicationShell)],B.prototype,"applicationShell",void 0),n([(0,r.inject)(c.MenuModelRegistry),o("design:type",c.MenuModelRegistry)],B.prototype,"menus",void 0),n([(0,r.inject)(f.ContextKeyService),o("design:type",Object)],B.prototype,"contextKeys",void 0),n([(0,r.inject)(D),o("design:type",D)],B.prototype,"options",void 0),n([(0,r.inject)(M),o("design:type",M)],B.prototype,"model",void 0),n([(0,r.inject)(f.ContextKeyService),o("design:type",Object)],B.prototype,"contextKeyService",void 0),n([(0,r.inject)(a.HoverService),o("design:type",a.HoverService)],B.prototype,"hoverService",void 0),n([(0,r.inject)(b.LabelParser),o("design:type",b.LabelParser)],B.prototype,"labelParser",void 0),n([(0,r.inject)(v.ColorRegistry),o("design:type",v.ColorRegistry)],B.prototype,"colorRegistry",void 0),n([(0,r.inject)(_.DnDFileContentStore),o("design:type",_.DnDFileContentStore)],B.prototype,"dndFileContentStore",void 0),n([(0,r.postConstruct)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],B.prototype,"init",null),B=n([(0,r.injectable)()],B),t.TreeViewWidget=B},17152:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TreeViewsMainImpl=void 0;const n=i(16138),o=i(79467),r=i(87361),s=i(62352),a=i(9825),c=i(46395),l=i(78054),d=i(58710),u=i(20607);t.TreeViewsMainImpl=class{constructor(e,t){this.container=t,this.treeViewProviders=new Map,this.toDispose=new a.DisposableCollection(a.Disposable.create((()=>{}))),this.proxy=e.getProxy(n.MAIN_RPC_CONTEXT.TREE_VIEWS_EXT),this.viewRegistry=t.get(o.PluginViewRegistry),this.contextKeys=this.container.get(s.ViewContextKeyService),this.widgetManager=this.container.get(r.WidgetManager),this.fileContentStore=this.container.get(u.DnDFileContentStore)}dispose(){this.toDispose.dispose()}async $registerTreeDataProvider(e,t){this.treeViewProviders.set(e,this.viewRegistry.registerViewDataProvider(e,(async({state:i,viewInfo:n})=>{const r={id:e,showCollapseAll:t.showCollapseAll,multiSelect:t.canSelectMany,dragMimeTypes:t.dragMimeTypes,dropMimeTypes:t.dropMimeTypes},s=await this.widgetManager.getOrCreateWidget(o.PLUGIN_VIEW_DATA_FACTORY_ID,r);if(s.model.viewInfo=n,i)s.restoreState(i),await s.model.refresh();else if(!s.model.root){const e={id:"",parent:void 0,name:"",visible:!1,expanded:!0,children:[]};s.model.root=e}return this.toDispose.disposed?s.model.proxy=void 0:(s.model.proxy=this.proxy,this.toDispose.push(a.Disposable.create((()=>s.model.proxy=void 0))),this.handleTreeEvents(s.id,s)),await s.model.refresh(),s}))),this.toDispose.push(a.Disposable.create((()=>this.$unregisterTreeDataProvider(e))))}async $unregisterTreeDataProvider(e){const t=this.treeViewProviders.get(e);t&&(this.treeViewProviders.delete(e),t.dispose())}async $readDroppedFile(e){const t=this.fileContentStore.getFile(e),i=await t.arrayBuffer();return d.BinaryBuffer.wrap(new Uint8Array(i))}async $refresh(e){const t=await this.viewRegistry.getView(e),i=t&&t.widgets[0];i instanceof c.TreeViewWidget&&await i.model.refresh()}async $reveal(e,t,i){const n=await this.viewRegistry.openView(e,{activate:i.focus,reveal:!0}),o=n&&n.widgets[0];if(o instanceof c.TreeViewWidget){const e=t.pop();await this.expandParentChain(o.model,t);const n=o.model.getNode(e);n&&(i.expand&&r.ExpandableTreeNode.is(n)&&await o.model.expandNode(n),i.select&&r.SelectableTreeNode.is(n)&&o.model.selectNode(n))}}async expandParentChain(e,t){for(const i of t){const t=e.getNode(i);r.ExpandableTreeNode.is(t)&&await e.expandNode(t)}}async $setMessage(e,t){const i=await this.viewRegistry.getView(e);i instanceof l.PluginViewWidget&&(i.message=t)}async $setTitle(e,t){const i=await this.viewRegistry.getView(e);i&&(i.title.label=t)}async $setDescription(e,t){const i=await this.viewRegistry.getView(e);i&&(i.description=t)}async $setBadge(e,t){const i=await this.viewRegistry.getView(e);i&&(i.badge=null==t?void 0:t.value,i.badgeTooltip=null==t?void 0:t.tooltip)}handleTreeEvents(e,t){this.toDispose.push(t.model.onExpansionChanged((t=>{this.proxy.$setExpanded(e,t.id,t.expanded)}))),this.toDispose.push(t.model.onSelectionChanged((t=>{this.contextKeys.view.set(e),this.proxy.$setSelection(e,t.map((e=>e.id)))})));const i=()=>this.proxy.$setVisible(e,t.isVisible);i(),this.toDispose.push(t.onDidChangeVisibility((()=>i())))}}},62352:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ViewContextKeyService=void 0;const r=i(70801),s=i(949);let a=class{get view(){return this._view}get viewItem(){return this._viewItem}get activeViewlet(){return this._activeViewlet}get activePanel(){return this._activePanel}get activeAuxiliary(){return this._activeAuxiliary}get focusedView(){return this._focusedView}init(){this._view=this.contextKeyService.createKey("view",""),this._viewItem=this.contextKeyService.createKey("viewItem",""),this._activeViewlet=this.contextKeyService.createKey("activeViewlet",""),this._activePanel=this.contextKeyService.createKey("activePanel",""),this._activeAuxiliary=this.contextKeyService.createKey("activeAuxiliary",""),this._focusedView=this.contextKeyService.createKey("focusedView","")}match(e){return!e||this.contextKeyService.match(e)}};n([(0,r.inject)(s.ContextKeyService),o("design:type",Object)],a.prototype,"contextKeyService",void 0),n([(0,r.postConstruct)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],a.prototype,"init",null),a=n([(0,r.injectable)()],a),t.ViewContextKeyService=a},35448:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.WebviewViewsMainImpl=void 0;const r=i(70801),s=i(16138),a=i(9825),c=i(87361),l=i(79467);class d{constructor(e,t,i){this.webviewsMain=i,this.toDispose=new a.DisposableCollection(a.Disposable.create((()=>{}))),this.webviewViews=new Map,this.webviewViewProviders=new Map,this.proxy=e.getProxy(s.MAIN_RPC_CONTEXT.WEBVIEW_VIEWS_EXT),this.widgetManager=t.get(c.WidgetManager),this.pluginViewRegistry=t.get(l.PluginViewRegistry)}dispose(){this.toDispose.dispose()}async $registerWebviewViewProvider(e,t){if(this.webviewViewProviders.has(e))throw new Error(`View provider for ${e} already registered`);const i=await this.pluginViewRegistry.registerWebviewView(e,{resolve:async(i,n)=>{const o=i.webview.identifier.id;let r;if(this.webviewViews.set(o,i),this.webviewsMain.hookWebview(i.webview),i.webview.state)try{r=JSON.parse(i.webview.state),console.log(r)}catch(e){console.error("Could not load webview state",e,i.webview.state)}t&&(i.webview.options=t),i.onDidChangeVisibility((e=>{this.proxy.$onDidChangeWebviewViewVisibility(o,e)})),i.onDidDispose((()=>{this.proxy.$disposeWebviewView(o),this.webviewViews.delete(o)}));try{this.proxy.$resolveWebviewView(o,e,i.title,r,n)}catch(t){this.logger.error(`Error resolving webview view '${e}': ${t}`),i.webview.setHTML("failed to load plugin webview view")}}});this.webviewViewProviders.set(e,i)}getWebview(e){return this.widgetManager.tryGetWidget(e)}$unregisterWebviewViewProvider(e){const t=this.webviewViewProviders.get(e);if(!t)throw new Error(`No view provider for ${e} registered`);t.dispose(),this.webviewViewProviders.delete(e)}$setWebviewViewTitle(e,t){this.getWebviewView(e).title=t}$setWebviewViewDescription(e,t){this.getWebviewView(e).description=t}async $setBadge(e,t){const i=this.getWebviewView(e);i&&(i.badge=null==t?void 0:t.value,i.badgeTooltip=null==t?void 0:t.tooltip)}$show(e,t){this.getWebviewView(e).show(t)}getWebviewView(e){const t=this.webviewViews.get(e);if(!t)throw new Error(`No webview view registered for handle '${e}'`);return t}}n([(0,r.inject)(a.ILogger),o("design:type",Object)],d.prototype,"logger",void 0),t.WebviewViewsMainImpl=d},50661:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.WebviewContextKeys=void 0;const r=i(70801),s=i(949),a=i(87361),c=i(4196);let l=class{init(){this.activeWebviewPanelId=this.contextKeyService.createKey("activeWebviewPanelId",""),this.applicationShell.onDidChangeCurrentWidget(this.handleDidChangeCurrentWidget,this)}handleDidChangeCurrentWidget(e){e.newValue instanceof c.WebviewWidget?this.activeWebviewPanelId.set(e.newValue.viewType):this.activeWebviewPanelId.set("")}};n([(0,r.inject)(a.ApplicationShell),o("design:type",a.ApplicationShell)],l.prototype,"applicationShell",void 0),n([(0,r.inject)(s.ContextKeyService),o("design:type",Object)],l.prototype,"contextKeyService",void 0),n([(0,r.postConstruct)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],l.prototype,"init",null),l=n([(0,r.injectable)()],l),t.WebviewContextKeys=l},47225:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.WebviewEnvironment=void 0;const r=i(70801),s=i(20820),a=i(60516),c=i(18234),l=i(9745),d=i(48074);let u=class{constructor(){this.externalEndpointHost=new a.Deferred}init(){this.doInit()}async doInit(){this._hostPatternPromise=this.getHostPattern();try{const e=await this.hostPatternPromise,{host:t}=new s.Endpoint;this.externalEndpointHost.resolve(e.replace("{{hostname}}",t))}catch(e){this.externalEndpointHost.reject(e)}}get hostPatternPromise(){return this._hostPatternPromise}async externalEndpointUrl(){const e=await this.externalEndpointHost.promise;return new s.Endpoint({host:e,path:"/webview"}).getRestUrl()}async externalEndpoint(){return(await this.externalEndpointUrl()).toString(!0)}async resourceRoot(e){return"frontend"===e?(await this.externalEndpointUrl()).withPath("{{path}}").toString(!0):(await this.externalEndpointUrl()).resolve("theia-resource/{{scheme}}//{{authority}}/{{path}}").toString(!0)}async cspSource(){return(await this.externalEndpointUrl()).withPath("").withQuery("").withFragment("").toString(!0).replace("{{uuid}}","*")}async getHostPattern(){return d.environment.electron.is()?l.WebviewExternalEndpoint.defaultPattern:this.environments.getValue(l.WebviewExternalEndpoint.pattern).then((e=>(null==e?void 0:e.value)||l.WebviewExternalEndpoint.defaultPattern))}};n([(0,r.inject)(c.EnvVariablesServer),o("design:type",Object)],u.prototype,"environments",void 0),n([(0,r.postConstruct)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],u.prototype,"init",null),u=n([(0,r.injectable)()],u),t.WebviewEnvironment=u},72806:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.WebviewFrontendSecurityWarnings=void 0;const r=i(9825),s=i(87361),a=i(50058),c=i(44989),l=i(51208),d=i(70801),u=i(9745),h=i(47225);let p=class{initialize(){this.checkHostPattern()}async checkHostPattern(){if(!1===a.FrontendApplicationConfigProvider.get().warnOnPotentiallyInsecureHostPattern)return;const e=await this.webviewEnvironment.hostPatternPromise;if(e!==u.WebviewExternalEndpoint.defaultPattern){const t=c.nls.localize("theia/webview/goToReadme","Go To README"),i=c.nls.localize("theia/webview/messageWarning","            The {0} endpoint's host pattern has been changed to `{1}`; changing the pattern can lead to security vulnerabilities.             See `{2}` for more information.","webview",e,"@theia/plugin-ext/README.md");this.messageService.warn(i,s.Dialog.OK,t).then((e=>{e===t&&this.windowService.openNewWindow("https://www.npmjs.com/package/@theia/plugin-ext",{external:!0})}))}}};n([(0,d.inject)(l.WindowService),o("design:type",Object)],p.prototype,"windowService",void 0),n([(0,d.inject)(r.MessageService),o("design:type",r.MessageService)],p.prototype,"messageService",void 0),n([(0,d.inject)(h.WebviewEnvironment),o("design:type",h.WebviewEnvironment)],p.prototype,"webviewEnvironment",void 0),p=n([(0,d.injectable)()],p),t.WebviewFrontendSecurityWarnings=p},85735:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bindWebviewPreferences=t.createWebviewPreferences=t.WebviewPreferences=t.WebviewPreferenceContribution=t.WebviewConfigSchema=void 0;const n=i(50058),o=i(98516),r=i(44989),s=n.FrontendApplicationConfigProvider.get();function a(e,i=t.WebviewConfigSchema){return(0,o.createPreferenceProxy)(e,i)}t.WebviewConfigSchema={type:"object",properties:{"webview.trace":{type:"string",enum:["off","on","verbose"],description:r.nls.localize("theia/plugin-ext/webviewTrace","Controls communication tracing with webviews."),default:"off"}}},s.securityWarnings&&(t.WebviewConfigSchema.properties["webview.warnIfUnsecure"]={scope:"application",type:"boolean",description:r.nls.localize("theia/plugin-ext/webviewWarnIfUnsecure","Warns users that webviews are currently deployed unsecurely."),default:!0}),t.WebviewPreferenceContribution=Symbol("WebviewPreferenceContribution"),t.WebviewPreferences=Symbol("WebviewPreferences"),t.createWebviewPreferences=a,t.bindWebviewPreferences=function(e){e(t.WebviewPreferences).toDynamicValue((e=>a(e.container.get(o.PreferenceService),e.container.get(t.WebviewPreferenceContribution).schema))).inSingletonScope(),e(t.WebviewPreferenceContribution).toConstantValue({schema:t.WebviewConfigSchema}),e(o.PreferenceContribution).toService(t.WebviewPreferenceContribution)}},3267:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.WebviewResourceCache=void 0;const r=i(70801),s=i(60516);let a=class{constructor(){this.cache=new s.Deferred,this.resolveCache()}async resolveCache(){try{this.cache.resolve(await caches.open("webview:v1"))}catch(e){console.error("Failed to enable webview caching: ",e),this.cache.resolve(void 0)}}async match(e){const t=await this.cache.promise;if(!t)return;const i=await t.match(e);return i?{eTag:i.headers.get("ETag")||void 0,body:async()=>{const e=await i.arrayBuffer();return new Uint8Array(e)}}:void 0}async delete(e){const t=await this.cache.promise;return!!t&&t.delete(e)}async put(e,t){if(!t.eTag)return;const i=await this.cache.promise;if(!i)return;const n=await t.body();await i.put(e,new Response(n,{status:200,headers:{ETag:t.eTag}}))}};a=n([(0,r.injectable)(),o("design:paramtypes",[])],a),t.WebviewResourceCache=a},80703:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.WebviewThemeDataProvider=void 0;const r=i(70801),s=i(18894),a=i(10473),c=i(20311),l=i(53414),d=i(22227);let u=class{constructor(){this.onDidChangeThemeDataEmitter=new s.Emitter,this.onDidChangeThemeData=this.onDidChangeThemeDataEmitter.event,this.editorStyles=new Map([["editor.fontFamily","editor-font-family"],["editor.fontWeight","editor-font-weight"],["editor.fontSize","editor-font-size"]])}init(){this.colorContribution.onDidChange((()=>this.reset())),this.editorPreferences.onPreferenceChanged((e=>{this.editorStyles.has(e.preferenceName)&&this.reset()}))}reset(){this.themeData&&(this.themeData=void 0,this.onDidChangeThemeDataEmitter.fire(void 0))}getThemeData(){return this.themeData||(this.themeData=this.computeThemeData()),this.themeData}computeThemeData(){const e={},t=(t,i)=>{if(i){const n="number"==typeof i||"string"==typeof i?i:String(i);e[this.colors.toCssVariableName(t).substring(2)]=n,e[this.colors.toCssVariableName(t,"vscode").substring(2)]=n}};t("font-family",'-apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif'),t("font-weight","normal"),t("font-size","13px"),this.editorStyles.forEach(((e,i)=>t(e,this.editorPreferences[i])));for(const e of this.colors.getColors()){const i=this.colors.getCurrentColor(e);i&&t(e,i.toString())}const i=this.getActiveTheme();return{styles:e,activeThemeName:i.label,activeThemeType:this.getThemeType(i)}}getActiveTheme(){return this.themeService.getCurrentTheme()}getThemeType(e){switch(e.type){case"light":return"vscode-light";case"dark":return"vscode-dark";default:return"vscode-high-contrast"}}};n([(0,r.inject)(a.EditorPreferences),o("design:type",Object)],u.prototype,"editorPreferences",void 0),n([(0,r.inject)(l.ColorRegistry),o("design:type",l.ColorRegistry)],u.prototype,"colors",void 0),n([(0,r.inject)(d.ColorApplicationContribution),o("design:type",d.ColorApplicationContribution)],u.prototype,"colorContribution",void 0),n([(0,r.inject)(c.ThemeService),o("design:type",c.ThemeService)],u.prototype,"themeService",void 0),n([(0,r.postConstruct)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],u.prototype,"init",null),u=n([(0,r.injectable)()],u),t.WebviewThemeDataProvider=u},57310:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebviewWidgetFactory=void 0;const n=i(4196),o=i(47225);t.WebviewWidgetFactory=class{constructor(e){this.id=n.WebviewWidget.FACTORY_ID,this.container=e}async createWidget(e){let t=(await this.container.get(o.WebviewEnvironment).externalEndpoint()).replace("{{uuid}}",e.id);"/"===t[t.length-1]&&(t=t.slice(0,t.length-1));const i=this.container.createChild();return i.bind(n.WebviewWidgetIdentifier).toConstantValue(e),i.bind(n.WebviewWidgetExternalEndpoint).toConstantValue(t),i.get(n.WebviewWidget)}}},4196:function(e,t,i){"use strict";var n,o=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.WebviewWidget=t.WebviewWidgetExternalEndpoint=t.WebviewWidgetIdentifier=void 0;const s=i(76517),a=i(28563),c=i(70801),l=i(35022),d=i(51138),u=i(80882),h=i(60516),p=i(47225),g=i(30970),f=i(18894),m=i(50869),b=i(82503),v=i(40824),A=i(34291),y=i(80703),C=i(80672),w=i(12690),_=i(85735),S=i(3267),E=i(20820),k=i(31262),x=i(14304),D=i(36090),T=i(58710);let M=class{};M=o([(0,c.injectable)()],M),t.WebviewWidgetIdentifier=M,t.WebviewWidgetExternalEndpoint=Symbol("WebviewWidgetExternalEndpoint");let B=n=class extends l.BaseWidget{constructor(){super(...arguments),this.viewState={visible:!1,active:!1,position:0},this.html="",this._contentOptions={},this.options={},this.ready=new h.Deferred,this.onMessageEmitter=new f.Emitter,this.onMessage=this.onMessageEmitter.event,this.pendingMessages=[],this.toHide=new d.DisposableCollection,this.isExtractable=!0,this.secondaryWindow=void 0,this.onDidChangeBadgeEmitter=new f.Emitter,this.onDidChangeBadgeTooltipEmitter=new f.Emitter,this.toDisposeOnIcon=new d.DisposableCollection}get contentOptions(){return this._contentOptions}get state(){return this._state}init(){this.node.tabIndex=0,this.id=n.FACTORY_ID+":"+this.identifier.id,this.title.closable=!0,this.addClass(n.Styles.WEBVIEW),this.toDispose.push(this.onMessageEmitter),this.toDispose.push(this.onDidChangeBadgeEmitter),this.toDispose.push(this.onDidChangeBadgeTooltipEmitter),this.transparentOverlay=document.createElement("div"),this.transparentOverlay.classList.add("theia-transparent-overlay"),this.transparentOverlay.style.display="none",this.node.appendChild(this.transparentOverlay),this.toDispose.push(this.mouseTracker.onMousedown((()=>{this.element&&"none"!==this.element.style.display&&(this.transparentOverlay.style.display="block")}))),this.toDispose.push(this.mouseTracker.onMouseup((()=>{this.element&&"none"!==this.element.style.display&&(this.transparentOverlay.style.display="none")})))}get onDidChangeBadge(){return this.onDidChangeBadgeEmitter.event}get onDidChangeBadgeTooltip(){return this.onDidChangeBadgeTooltipEmitter.event}get badge(){return this._badge}set badge(e){this._badge=e,this.onDidChangeBadgeEmitter.fire()}get badgeTooltip(){return this._badgeTooltip}set badgeTooltip(e){this._badgeTooltip=e,this.onDidChangeBadgeTooltipEmitter.fire()}onBeforeAttach(e){super.onBeforeAttach(e),this.doShow(),this.toDisposeOnDetach.push(d.Disposable.create((()=>this.forceHide())))}onAfterAttach(e){super.onAfterAttach(e),this.addEventListener(this.node,"focus",(()=>{this.element&&this.doSend("focus")}))}onBeforeShow(e){super.onBeforeShow(e),this.doShow()}onAfterHide(e){super.onAfterHide(e),this.doHide()}doHide(){!0!==this.options.retainContextWhenHidden&&void 0===this.hideTimeout&&(this.hideTimeout=setTimeout((()=>this.forceHide()),50))}forceHide(){clearTimeout(this.hideTimeout),this.hideTimeout=void 0,this.toHide.dispose()}doShow(){if(clearTimeout(this.hideTimeout),this.hideTimeout=void 0,!this.toHide.disposed)return;this.toDispose.push(this.toHide);const e=document.createElement("iframe");e.className="webview",e.sandbox.add("allow-scripts","allow-forms","allow-same-origin","allow-downloads"),k.isFirefox||e.setAttribute("allow","clipboard-read; clipboard-write; usb; serial; hid;"),e.setAttribute("src",`${this.externalEndpoint}/index.html?id=${this.identifier.id}`),e.style.border="none",e.style.width="100%",e.style.height="100%",this.element=e,this.node.appendChild(this.element),this.toHide.push(d.Disposable.create((()=>{this.element&&(this.element.remove(),this.element=void 0)})));const t=this.ready,i=new h.Deferred;i.promise.then((()=>t.resolve())),this.ready=i,this.toHide.push(d.Disposable.create((()=>this.ready=new h.Deferred)));const n=this.on("webview-ready",(()=>{n.dispose(),i.resolve()}));for(this.toHide.push(n),this.toHide.push(this.on("onmessage",(e=>this.onMessageEmitter.fire(e)))),this.toHide.push(this.on("did-click-link",(e=>this.openLink(new g.default(e))))),this.toHide.push(this.on("do-update-state",(e=>{this._state=e}))),this.toHide.push(this.on("did-focus",(()=>this.node.dispatchEvent(new FocusEvent("focus"))))),this.toHide.push(this.on("did-blur",(()=>{}))),this.toHide.push(this.on("do-reload",(()=>this.reload()))),this.toHide.push(this.on("load-resource",(e=>this.loadResource(e.path)))),this.toHide.push(this.on("load-localhost",(e=>this.loadLocalhost(e.origin)))),this.toHide.push(this.on("did-keydown",(e=>{this.keybindings.dispatchKeyDown(e,this.element)}))),this.toHide.push(this.on("did-mousedown",(e=>{this.dispatchMouseEvent("mousedown",e)}))),this.toHide.push(this.on("did-mouseup",(e=>{this.dispatchMouseEvent("mouseup",e)}))),this.style(),this.toHide.push(this.themeDataProvider.onDidChangeThemeData((()=>this.style()))),this.doUpdateContent();this.pendingMessages.length;)this.sendMessage(this.pendingMessages.shift())}async loadLocalhost(e){const t=await this.getRedirect(e);return this.doSend("did-load-localhost",{origin:e,location:t})}dispatchMouseEvent(e,t){const i=this.node.getBoundingClientRect();document.dispatchEvent(new MouseEvent(e,{...t,clientX:i.x+t.clientX,clientY:i.y+t.clientY}))}async getRedirect(e){const t=new g.default(e),i=this.externalUriService.parseLocalhost(t);if(i){if(this._contentOptions.portMapping)for(const e of this._contentOptions.portMapping)if(e.webviewPort===i.port&&e.webviewPort!==e.extensionHostPort)return this.toRemoteUrl(t.withAuthority(`${i.address}:${e.extensionHostPort}`));return this.toRemoteUrl(t)}}async toRemoteUrl(e){const t=(await this.externalUriService.resolve(e)).toString();return"/"===t[t.length-1]?t.slice(0,t.length-1):t}setContentOptions(e){a.JSONExt.deepEqual(this.contentOptions,e)||(this._contentOptions=e,this.doUpdateContent())}setIconUrl(e){if(!(this.iconUrl&&e&&a.JSONExt.deepEqual(this.iconUrl,e)||this.iconUrl===e))if(this.toDisposeOnIcon.dispose(),this.toDispose.push(this.toDisposeOnIcon),this.iconUrl=e,e){const t="object"==typeof e?e.dark:e,i="object"==typeof e?e.light:e,n=`webview-${this.identifier.id}-file-icon`;this.toDisposeOnIcon.push(this.sharedStyle.insertRule(`.theia-webview-icon.${n}::before`,(e=>`background-image: url(${this.toEndpoint("light"===e.type?i:t)});`))),this.title.iconClass=`theia-webview-icon ${n}`}else this.title.iconClass=""}toEndpoint(e){return new E.Endpoint({path:e}).getRestUrl().toString()}setHTML(e){this.html=this.preprocessHtml(e),this.doUpdateContent()}preprocessHtml(e){return e.replace(/(["'])(?:vscode|theia)-resource:(\/\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,((e,t,i,n,o,r)=>n?`${t}${this.externalEndpoint}/theia-resource/${n}${o}${r}`:`${t}${this.externalEndpoint}/theia-resource/file${o}${r}`))}onActivateRequest(e){super.onActivateRequest(e),this.node.focus()}reload(){this.doUpdateContent()}style(){const{styles:e,activeThemeType:t,activeThemeName:i}=this.themeDataProvider.getThemeData();this.doSend("styles",{styles:e,activeThemeType:t,activeThemeName:i})}openLink(e){const t=this.toSupportedLink(e);t&&(0,m.open)(this.openerService,t)}toSupportedLink(e){if(n.standardSupportedLinkSchemes.has(e.scheme)){const t=e.toString();for(const e of[this.externalEndpoint+"/theia-resource",this.externalEndpoint+"/vscode-resource"])if(t.startsWith(e+"/"))return this.normalizeRequestUri(t.substring(e.length));return e}if(e.scheme===v.Schemes.command){if(Array.isArray(this.contentOptions.enableCommandUris)&&this.contentOptions.enableCommandUris.some((t=>t===e.path.toString())))return e;if(!0===this.contentOptions.enableCommandUris)return e}}async loadResource(e){const t=this.normalizeRequestUri(e),i=new E.Endpoint({path:t.path.toString()}).getRestUrl().toString();try{if(this.contentOptions.localResourceRoots)for(const n of this.contentOptions.localResourceRoots){if(!new g.default(n).path.isEqualOrParent(t.path))continue;let o=await this.resourceCache.match(i);try{const e=await this.fileService.readFileStream(t,{etag:null==o?void 0:o.eTag}),{buffer:n}=await T.BinaryBufferReadableStream.toBuffer(e.value);o={body:()=>n,eTag:e.etag},this.resourceCache.put(i,o)}catch(e){if(!(e instanceof D.FileOperationError&&2===e.fileOperationResult))throw e}if(o){const i=await o.body();return this.doSend("did-load-resource",{status:200,path:e,mime:s.getType(t.path.toString())||"application/octet-stream",data:i})}}}catch{}return this.resourceCache.delete(i),this.doSend("did-load-resource",{status:404,path:e})}normalizeRequestUri(e){const t=decodeURIComponent(e),i=new g.default(t.replace(/^\/([a-zA-Z0-9.\-+]+)\/(.+)$/,((e,t,i)=>t+":/"+i)));return"theia-resource"!==i.scheme&&"vscode-resource"!==i.scheme?i:i.authority?new g.default(i.authority+":"+i.path):i.withScheme("file")}sendMessage(e){this.element?this.doSend("message",e):this.pendingMessages.push(e)}doUpdateContent(){this.doSend("content",{contents:this.html,options:this.contentOptions,state:this.state})}storeState(){return{viewType:this.viewType,title:this.title.label,iconUrl:this.iconUrl,options:this.options,contentOptions:this.contentOptions,state:this.state}}restoreState(e){const{viewType:t,title:i,iconUrl:n,options:o,contentOptions:r,state:s}=e;this.viewType=t,this.title.label=i,this.setIconUrl(n),this.options=o,this._contentOptions=r,this._state=s}async doSend(e,t){if(this.element)try{await this.ready.promise,this.postMessage(e,t)}catch(e){console.error(e)}}postMessage(e,t){this.element&&(this.trace("out",e,t),this.secondaryWindow?this.seco